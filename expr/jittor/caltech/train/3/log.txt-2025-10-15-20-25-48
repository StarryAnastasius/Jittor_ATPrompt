***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['TRAINER.COOP.N_CTX', '4', 'TRAINER.COOP.CSC', 'False', 'TRAINER.COOP.CLASS_TOKEN_POSITION', 'end', 'DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base', 'TRAINER.ATPROMPT.USE_ATPROMPT', 'True', 'TRAINER.ATPROMPT.N_ATT1', '4', 'TRAINER.ATPROMPT.N_ATT2', '4', 'TRAINER.ATPROMPT.N_ATT3', '4', 'OPTIM.MAX_EPOCH', '25', 'TRAIN.CHECKPOINT_FREQ', '1']
output_dir: output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3
resume: 
root: /root/prompt_dataset
seed: 3
source_domains: None
target_domains: None
trainer: CoOp_ATP
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 50
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 4
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: Caltech101
  NUM_LABELED: -1
  NUM_SHOTS: 16
  ROOT: /root/prompt_dataset
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 25
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 1
  COUNT_ITER: train_x
  PRINT_FREQ: 20
TRAINER:
  ATPROMPT:
    ATT1_TEXT: shape
    ATT2_TEXT: size
    ATT3_TEXT: none
    ATT_NUM: 2
    N_ATT1: 4
    N_ATT2: 4
    N_ATT3: 4
    USE_ATPROMPT: True
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: False
    N_CTX: 4
    PREC: fp16
    W: 2.0
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FILM:
    LINEAR_PROBE: True
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  IVLP:
    CTX_INIT: a photo of a
    IMG_WEIGHT: 0.5
    N_CTX_TEXT: 2
    N_CTX_VISION: 2
    PREC: fp16
    PROMPT_DEPTH_TEXT: 9
    PROMPT_DEPTH_VISION: 9
  LINEAR_PROBE:
    TEST_TIME_FUSION: True
    TYPE: linear
    WEIGHT: 0.7
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MAPLE:
    CTX_INIT: a photo of a
    N_CTX: 2
    PREC: fp16
    PROMPT_DEPTH: 9
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp_ATP
  NAMES_TO_UPDATE: ['prompt_learner', 'linear_probe', 'film']
  PROMPTSRC:
    CTX_INIT: 
    GPA_MEAN: 15
    GPA_STD: 1
    IMAGE_LOSS_WEIGHT: 10
    N_CTX_TEXT: 4
    N_CTX_VISION: 4
    PREC: fp16
    PROMPT_DEPTH_TEXT: 9
    PROMPT_DEPTH_VISION: 9
    TEXT_LOSS_WEIGHT: 25
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Loading trainer: CoOp_ATP

=== DATALOADER DUMP (test) ===
cfg.DATASET.NAME: Caltech101
cfg.DATASET.SUBSAMPLE_CLASSES: base
cfg.DATASET.NUM_SHOTS: 16
cfg.INPUT.SIZE: (224, 224)
No loader found for test

=== DATALOADER DUMP (train) ===
cfg.DATASET.NAME: Caltech101
cfg.DATASET.SUBSAMPLE_CLASSES: base
cfg.DATASET.NUM_SHOTS: 16
cfg.INPUT.SIZE: (224, 224)
No loader found for train
=== 开始执行 build_data_loader，准备统计样本数 ===
Loading dataset: Caltech101
Reading split from /root/prompt_dataset/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /root/prompt_dataset/caltech-101/split_fewshot/shot_16-seed_3.pkl
当前 SUBSAMPLE_CLASSES 配置: base
SUBSAMPLE BASE CLASSES!
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test

===== 数据集原始长度信息 =====
测试集原始长度 (len(dataset.test)): 1549
训练集原始长度 (len(dataset.train_x)): 800
类别数: 50
SUBSAMPLE_CLASSES 配置: base
=============================

统计样本数时出错: 'list' object has no attribute 'data_list'
train_loader_x 的 batch 数: 200
单个 batch 样本数: 4
train_loader_x 总样本数（batch数 × batch_size）: 800
train_loader_x.dataset 长度: 200
Loading CLIP (backbone: ViT-B/16)
Initializing a generic context
self.use_atp is True
self.atp_num is 2
Initial context: "X X X X"
Number of context words (tokens): 4
USE ATPROPMT-ING 1
['X X X X shape X X X X size X X X X face.', 'X X X X shape X X X X size X X X X leopard.', 'X X X X shape X X X X size X X X X motorbike.', 'X X X X shape X X X X size X X X X accordion.', 'X X X X shape X X X X size X X X X airplane.', 'X X X X shape X X X X size X X X X anchor.', 'X X X X shape X X X X size X X X X ant.', 'X X X X shape X X X X size X X X X barrel.', 'X X X X shape X X X X size X X X X bass.', 'X X X X shape X X X X size X X X X beaver.', 'X X X X shape X X X X size X X X X binocular.', 'X X X X shape X X X X size X X X X bonsai.', 'X X X X shape X X X X size X X X X brain.', 'X X X X shape X X X X size X X X X brontosaurus.', 'X X X X shape X X X X size X X X X buddha.', 'X X X X shape X X X X size X X X X butterfly.', 'X X X X shape X X X X size X X X X camera.', 'X X X X shape X X X X size X X X X cannon.', 'X X X X shape X X X X size X X X X car side.', 'X X X X shape X X X X size X X X X ceiling fan.', 'X X X X shape X X X X size X X X X cellphone.', 'X X X X shape X X X X size X X X X chair.', 'X X X X shape X X X X size X X X X chandelier.', 'X X X X shape X X X X size X X X X cougar body.', 'X X X X shape X X X X size X X X X cougar face.', 'X X X X shape X X X X size X X X X crab.', 'X X X X shape X X X X size X X X X crayfish.', 'X X X X shape X X X X size X X X X crocodile.', 'X X X X shape X X X X size X X X X crocodile head.', 'X X X X shape X X X X size X X X X cup.', 'X X X X shape X X X X size X X X X dalmatian.', 'X X X X shape X X X X size X X X X dollar bill.', 'X X X X shape X X X X size X X X X dolphin.', 'X X X X shape X X X X size X X X X dragonfly.', 'X X X X shape X X X X size X X X X electric guitar.', 'X X X X shape X X X X size X X X X elephant.', 'X X X X shape X X X X size X X X X emu.', 'X X X X shape X X X X size X X X X euphonium.', 'X X X X shape X X X X size X X X X ewer.', 'X X X X shape X X X X size X X X X ferry.', 'X X X X shape X X X X size X X X X flamingo.', 'X X X X shape X X X X size X X X X flamingo head.', 'X X X X shape X X X X size X X X X garfield.', 'X X X X shape X X X X size X X X X gerenuk.', 'X X X X shape X X X X size X X X X gramophone.', 'X X X X shape X X X X size X X X X grand piano.', 'X X X X shape X X X X size X X X X hawksbill.', 'X X X X shape X X X X size X X X X headphone.', 'X X X X shape X X X X size X X X X hedgehog.', 'X X X X shape X X X X size X X X X helicopter.']
embedding shape is [50,77,512,]
USE ATPROPMT-ING 2

===== 开始构建优化器 =====
优化器类型: sgd
学习率 (LR): 0.002
权重衰减 (WEIGHT_DECAY): 0.0005
参数组 (param_groups) 为None，开始自动构建参数组...
不启用分段学习率，使用模型所有参数...
参数组总参数数量: 9

开始初始化优化器: sgd
SGD参数 - 学习率: 0.002, 动量: 0.9, 权重衰减: 0.0005
优化器构建成功: SGD
===== 优化器构建结束 =====

=== 开始执行 build_data_loader，准备统计样本数 ===
Loading dataset: Caltech101
Reading split from /root/prompt_dataset/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /root/prompt_dataset/caltech-101/split_fewshot/shot_16-seed_3.pkl
当前 SUBSAMPLE_CLASSES 配置: base
SUBSAMPLE BASE CLASSES!

===== 数据集原始长度信息 =====
测试集原始长度 (len(dataset.test)): 1549
训练集原始长度 (len(dataset.train_x)): 800
类别数: 50
SUBSAMPLE_CLASSES 配置: base
=============================

统计样本数时出错: 'list' object has no attribute 'data_list'
train_loader_x 的 batch 数: 200
单个 batch 样本数: 4
train_loader_x 总样本数（batch数 × batch_size）: 800
train_loader_x.dataset 长度: 200
Loading evaluator: Classification
未找到 checkpoint，从头训练
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000272
epoch [1/25] batch [20/200] time 8.925 (6.655) data 8.685 (6.396) loss 0.6297 (1.1228) acc 75.0000 (73.7500) lr 2.7190e-04 eta 9:12:21
[调度器验证] batch 40: 学习率=0.001188
epoch [1/25] batch [40/200] time 13.703 (9.043) data 13.464 (8.795) loss 1.6341 (1.0128) acc 50.0000 (75.0000) lr 1.1878e-03 eta 12:27:34
[调度器验证] batch 60: 学习率=0.001426
epoch [1/25] batch [60/200] time 18.462 (11.429) data 18.224 (11.185) loss 1.8224 (1.0598) acc 50.0000 (73.7500) lr 1.4261e-03 eta 15:41:01
[调度器验证] batch 80: 学习率=0.000125
epoch [1/25] batch [80/200] time 23.233 (13.812) data 22.989 (13.569) loss 0.7253 (1.0496) acc 75.0000 (74.3750) lr 1.2463e-04 eta 18:52:34
[调度器验证] batch 100: 学习率=0.001992
epoch [1/25] batch [100/200] time 28.049 (16.201) data 27.808 (15.959) loss 1.7354 (1.0899) acc 75.0000 (74.5000) lr 1.9921e-03 eta 22:03:05
[调度器验证] batch 120: 学习率=0.000272
epoch [1/25] batch [120/200] time 32.823 (18.594) data 32.585 (18.352) loss 1.2864 (1.0450) acc 75.0000 (75.0000) lr 2.7190e-04 eta 1 day, 1:12:16
[调度器验证] batch 140: 学习率=0.001188
epoch [1/25] batch [140/200] time 37.580 (20.983) data 37.343 (20.742) loss 1.0330 (1.0014) acc 25.0000 (75.1786) lr 1.1878e-03 eta 1 day, 4:19:39
[调度器验证] batch 160: 学习率=0.001426
epoch [1/25] batch [160/200] time 42.353 (23.371) data 42.117 (23.130) loss 0.5535 (1.0056) acc 75.0000 (74.6875) lr 1.4261e-03 eta 1 day, 7:25:16
[调度器验证] batch 180: 学习率=0.000125
epoch [1/25] batch [180/200] time 47.136 (25.759) data 46.898 (25.519) loss 1.7728 (0.9671) acc 25.0000 (75.1389) lr 1.2463e-04 eta 1 day, 10:29:20
[调度器验证] batch 200: 学习率=0.002000
epoch [1/25] batch [200/200] time 51.949 (28.150) data 51.710 (27.910) loss 0.8199 (0.9351) acc 75.0000 (76.0000) lr 2.0000e-03 eta 1 day, 13:32:00
保存调度器 prompt_learner 的手动状态: {'last_epoch': 200}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-1
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000192
epoch [2/25] batch [20/200] time 4.804 (2.522) data 4.566 (2.282) loss 0.4657 (0.4625) acc 100.0000 (87.5000) lr 1.9189e-04 eta 3:20:54
[调度器验证] batch 40: 学习率=0.001309
epoch [2/25] batch [40/200] time 9.588 (4.918) data 9.348 (4.679) loss 0.4901 (0.5049) acc 75.0000 (84.3750) lr 1.3094e-03 eta 6:30:09
[调度器验证] batch 60: 学习率=0.001309
epoch [2/25] batch [60/200] time 14.433 (7.319) data 14.179 (7.079) loss 0.3997 (0.4694) acc 100.0000 (85.4167) lr 1.3094e-03 eta 9:38:12
[调度器验证] batch 80: 学习率=0.000192
epoch [2/25] batch [80/200] time 19.193 (9.723) data 18.953 (9.483) loss 0.0817 (0.4905) acc 100.0000 (84.6875) lr 1.9189e-04 eta 12:44:51
[调度器验证] batch 100: 学习率=0.002000
epoch [2/25] batch [100/200] time 23.959 (12.118) data 23.721 (11.879) loss 0.1958 (0.4626) acc 100.0000 (86.0000) lr 2.0000e-03 eta 15:49:15
[调度器验证] batch 120: 学习率=0.000192
epoch [2/25] batch [120/200] time 28.749 (14.510) data 28.510 (14.271) loss 0.9088 (0.4766) acc 75.0000 (85.2083) lr 1.9189e-04 eta 18:51:45
[调度器验证] batch 140: 学习率=0.001309
epoch [2/25] batch [140/200] time 33.530 (16.902) data 33.290 (16.663) loss 0.6168 (0.4715) acc 75.0000 (85.0000) lr 1.3094e-03 eta 21:52:41
[调度器验证] batch 160: 学习率=0.001309
epoch [2/25] batch [160/200] time 38.303 (19.293) data 38.065 (19.054) loss 0.0025 (0.4809) acc 100.0000 (85.1562) lr 1.3094e-03 eta 1 day, 0:52:01
[调度器验证] batch 180: 学习率=0.000192
epoch [2/25] batch [180/200] time 43.109 (21.686) data 42.869 (21.447) loss 0.4718 (0.5222) acc 75.0000 (84.0278) lr 1.9189e-04 eta 1 day, 3:49:49
[调度器验证] batch 200: 学习率=0.001992
epoch [2/25] batch [200/200] time 47.909 (24.080) data 47.670 (23.841) loss 0.0116 (0.5213) acc 100.0000 (84.0000) lr 1.9921e-03 eta 1 day, 6:46:08
保存调度器 prompt_learner 的手动状态: {'last_epoch': 401}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-2
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000125
epoch [3/25] batch [20/200] time 4.826 (2.530) data 4.588 (2.289) loss 0.0452 (0.4487) acc 100.0000 (87.5000) lr 1.2463e-04 eta 3:13:08
[调度器验证] batch 40: 学习率=0.001426
epoch [3/25] batch [40/200] time 9.620 (4.936) data 9.381 (4.696) loss 0.2471 (0.3238) acc 100.0000 (91.8750) lr 1.4261e-03 eta 6:15:09
[调度器验证] batch 60: 学习率=0.001188
epoch [3/25] batch [60/200] time 14.413 (7.337) data 14.175 (7.097) loss 0.0410 (0.3869) acc 100.0000 (88.3333) lr 1.1878e-03 eta 9:15:10
[调度器验证] batch 80: 学习率=0.000272
epoch [3/25] batch [80/200] time 18.763 (9.729) data 18.956 (9.495) loss 0.4517 (0.3840) acc 75.0000 (88.1250) lr 2.7190e-04 eta 12:12:55
[调度器验证] batch 100: 学习率=0.001992
epoch [3/25] batch [100/200] time 23.571 (12.040) data 23.330 (11.805) loss 0.3877 (0.3822) acc 100.0000 (88.0000) lr 1.9921e-03 eta 15:03:01
[调度器验证] batch 120: 学习率=0.000125
epoch [3/25] batch [120/200] time 28.356 (14.382) data 28.118 (14.146) loss 0.0302 (0.4100) acc 100.0000 (87.2917) lr 1.2463e-04 eta 17:53:49
[调度器验证] batch 140: 学习率=0.001426
epoch [3/25] batch [140/200] time 33.149 (16.737) data 32.909 (16.501) loss 0.8483 (0.4079) acc 75.0000 (87.5000) lr 1.4261e-03 eta 20:44:06
[调度器验证] batch 160: 学习率=0.001188
epoch [3/25] batch [160/200] time 37.932 (19.102) data 37.694 (18.866) loss 1.1301 (0.4235) acc 75.0000 (86.8750) lr 1.1878e-03 eta 23:33:33
[调度器验证] batch 180: 学习率=0.000272
epoch [3/25] batch [180/200] time 42.733 (21.474) data 42.494 (21.237) loss 0.7680 (0.4242) acc 75.0000 (86.6667) lr 2.7190e-04 eta 1 day, 2:21:55
[调度器验证] batch 200: 学习率=0.001969
epoch [3/25] batch [200/200] time 47.535 (23.852) data 47.296 (23.615) loss 0.5195 (0.4305) acc 75.0000 (86.5000) lr 1.9686e-03 eta 1 day, 5:09:09
保存调度器 prompt_learner 的手动状态: {'last_epoch': 602}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-3
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000071
epoch [4/25] batch [20/200] time 4.822 (2.533) data 4.578 (2.293) loss 0.8917 (0.5620) acc 75.0000 (82.5000) lr 7.1188e-05 eta 3:04:55
[调度器验证] batch 40: 学习率=0.001536
epoch [4/25] batch [40/200] time 9.633 (4.942) data 9.396 (4.702) loss 0.6881 (0.5727) acc 75.0000 (81.8750) lr 1.5361e-03 eta 5:59:07
[调度器验证] batch 60: 学习率=0.001063
epoch [4/25] batch [60/200] time 14.411 (7.341) data 14.172 (7.101) loss 0.5626 (0.4881) acc 75.0000 (84.1667) lr 1.0633e-03 eta 8:51:00
[调度器验证] batch 80: 学习率=0.000363
epoch [4/25] batch [80/200] time 19.204 (9.737) data 18.965 (9.497) loss 0.9399 (0.4600) acc 75.0000 (85.6250) lr 3.6339e-04 eta 11:41:03
[调度器验证] batch 100: 学习率=0.001969
epoch [4/25] batch [100/200] time 23.979 (12.132) data 23.741 (11.893) loss 0.0319 (0.4546) acc 100.0000 (85.7500) lr 1.9686e-03 eta 14:29:28
[调度器验证] batch 120: 学习率=0.000071
epoch [4/25] batch [120/200] time 28.764 (14.525) data 28.526 (14.286) loss 0.0524 (0.4364) acc 100.0000 (86.4583) lr 7.1188e-05 eta 17:16:06
[调度器验证] batch 140: 学习率=0.001536
epoch [4/25] batch [140/200] time 33.554 (16.918) data 33.314 (16.679) loss 2.2857 (0.4571) acc 25.0000 (86.2500) lr 1.5361e-03 eta 20:01:10
[调度器验证] batch 160: 学习率=0.001063
epoch [4/25] batch [160/200] time 38.380 (19.313) data 38.140 (19.074) loss 0.5351 (0.4539) acc 100.0000 (86.7188) lr 1.0633e-03 eta 22:44:48
[调度器验证] batch 180: 学习率=0.000363
epoch [4/25] batch [180/200] time 43.209 (21.714) data 42.968 (21.474) loss 0.8290 (0.4501) acc 75.0000 (86.8056) lr 3.6339e-04 eta 1 day, 1:27:11
[调度器验证] batch 200: 学习率=0.001930
epoch [4/25] batch [200/200] time 48.034 (24.117) data 47.793 (23.877) loss 0.0138 (0.4412) acc 100.0000 (87.1250) lr 1.9298e-03 eta 1 day, 4:08:09
保存调度器 prompt_learner 的手动状态: {'last_epoch': 803}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-4
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000032
epoch [5/25] batch [20/200] time 4.835 (2.542) data 4.593 (2.300) loss 0.3633 (0.1871) acc 75.0000 (93.7500) lr 3.2401e-05 eta 2:57:03
[调度器验证] batch 40: 学习率=0.001638
epoch [5/25] batch [40/200] time 9.672 (4.957) data 9.430 (4.716) loss 0.0044 (0.2509) acc 100.0000 (91.8750) lr 1.6376e-03 eta 5:43:40
[调度器验证] batch 60: 学习率=0.000938
epoch [5/25] batch [60/200] time 14.464 (7.368) data 14.227 (7.128) loss 0.1419 (0.2776) acc 100.0000 (91.6667) lr 9.3774e-04 eta 8:28:24
[调度器验证] batch 80: 学习率=0.000465
epoch [5/25] batch [80/200] time 19.264 (9.773) data 19.025 (9.533) loss 0.4719 (0.3331) acc 75.0000 (90.6250) lr 4.6494e-04 eta 11:11:04
[调度器验证] batch 100: 学习率=0.001930
epoch [5/25] batch [100/200] time 24.071 (12.176) data 23.832 (11.936) loss 1.4914 (0.3662) acc 50.0000 (89.2500) lr 1.9298e-03 eta 13:52:01
[调度器验证] batch 120: 学习率=0.000032
epoch [5/25] batch [120/200] time 28.904 (14.582) data 28.662 (14.342) loss 0.0242 (0.3403) acc 100.0000 (89.3750) lr 3.2401e-05 eta 16:31:35
[调度器验证] batch 140: 学习率=0.001638
epoch [5/25] batch [140/200] time 33.694 (16.987) data 33.455 (16.747) loss 0.0063 (0.3284) acc 100.0000 (90.0000) lr 1.6376e-03 eta 19:09:28
[调度器验证] batch 160: 学习率=0.000938
epoch [5/25] batch [160/200] time 38.516 (19.391) data 38.271 (19.151) loss 0.0700 (0.3541) acc 100.0000 (89.6875) lr 9.3774e-04 eta 21:45:39
[调度器验证] batch 180: 学习率=0.000465
epoch [5/25] batch [180/200] time 43.322 (21.797) data 43.084 (21.556) loss 1.5139 (0.3532) acc 75.0000 (89.7222) lr 4.6494e-04 eta 1 day, 0:20:22
[调度器验证] batch 200: 学习率=0.001876
epoch [5/25] batch [200/200] time 48.133 (24.202) data 47.893 (23.962) loss 0.0534 (0.3628) acc 100.0000 (89.6250) lr 1.8764e-03 eta 1 day, 2:53:27
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1004}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-5
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000009
epoch [6/25] batch [20/200] time 4.852 (2.542) data 4.611 (2.300) loss 0.8298 (0.5390) acc 75.0000 (83.7500) lr 8.8814e-06 eta 2:48:37
[调度器验证] batch 40: 学习率=0.001729
epoch [6/25] batch [40/200] time 9.702 (4.973) data 9.462 (4.731) loss 0.4946 (0.4028) acc 100.0000 (87.5000) lr 1.7291e-03 eta 5:28:14
[调度器验证] batch 60: 学习率=0.000813
epoch [6/25] batch [60/200] time 14.524 (7.394) data 14.283 (7.153) loss 0.1154 (0.3763) acc 100.0000 (90.0000) lr 8.1321e-04 eta 8:05:33
[调度器验证] batch 80: 学习率=0.000575
epoch [6/25] batch [80/200] time 19.339 (9.810) data 19.099 (9.569) loss 0.3783 (0.3458) acc 100.0000 (90.6250) lr 5.7493e-04 eta 10:40:54
[调度器验证] batch 100: 学习率=0.001876
epoch [6/25] batch [100/200] time 24.158 (12.221) data 23.917 (11.980) loss 0.0524 (0.3247) acc 100.0000 (91.0000) lr 1.8764e-03 eta 13:14:22
[调度器验证] batch 120: 学习率=0.000009
epoch [6/25] batch [120/200] time 28.976 (14.632) data 28.734 (14.391) loss 0.0026 (0.3254) acc 100.0000 (90.4167) lr 8.8814e-06 eta 15:46:12
[调度器验证] batch 140: 学习率=0.001729
epoch [6/25] batch [140/200] time 33.791 (17.042) data 33.554 (16.801) loss 0.0095 (0.3246) acc 100.0000 (90.7143) lr 1.7291e-03 eta 18:16:23
[调度器验证] batch 160: 学习率=0.000813
epoch [6/25] batch [160/200] time 38.625 (19.453) data 38.386 (19.212) loss 0.0106 (0.3246) acc 100.0000 (90.9375) lr 8.1321e-04 eta 20:45:00
[调度器验证] batch 180: 学习率=0.000575
epoch [6/25] batch [180/200] time 43.589 (21.876) data 43.351 (21.634) loss 0.0418 (0.3395) acc 100.0000 (90.5556) lr 5.7493e-04 eta 23:12:44
[调度器验证] batch 200: 学习率=0.001809
epoch [6/25] batch [200/200] time 48.355 (24.297) data 48.121 (24.056) loss 0.5542 (0.3331) acc 75.0000 (90.6250) lr 1.8091e-03 eta 1 day, 1:38:49
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1205}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-6
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000001
epoch [7/25] batch [20/200] time 4.748 (2.497) data 4.510 (2.261) loss 0.0385 (0.2227) acc 100.0000 (95.0000) lr 1.0000e-06 eta 2:37:20
[调度器验证] batch 40: 学习率=0.001809
epoch [7/25] batch [40/200] time 9.457 (4.862) data 9.223 (4.626) loss 0.2190 (0.1966) acc 100.0000 (93.7500) lr 1.8091e-03 eta 5:04:41
[调度器验证] batch 60: 学习率=0.000692
epoch [7/25] batch [60/200] time 14.175 (7.218) data 13.939 (6.983) loss 0.1018 (0.2450) acc 100.0000 (92.0833) lr 6.9164e-04 eta 7:29:56
[调度器验证] batch 80: 学习率=0.000692
epoch [7/25] batch [80/200] time 18.893 (9.578) data 18.659 (9.342) loss 0.3153 (0.2331) acc 75.0000 (92.8125) lr 6.9164e-04 eta 9:53:49
[调度器验证] batch 100: 学习率=0.001809
epoch [7/25] batch [100/200] time 23.615 (11.936) data 23.379 (11.701) loss 0.0003 (0.2403) acc 100.0000 (93.0000) lr 1.8091e-03 eta 12:16:04
[调度器验证] batch 120: 学习率=0.000001
epoch [7/25] batch [120/200] time 28.315 (14.293) data 28.080 (14.058) loss 0.0014 (0.2813) acc 100.0000 (92.2917) lr 1.0000e-06 eta 14:36:38
[调度器验证] batch 140: 学习率=0.001809
epoch [7/25] batch [140/200] time 33.012 (16.648) data 32.772 (16.412) loss 0.0114 (0.3113) acc 100.0000 (91.6071) lr 1.8091e-03 eta 16:55:31
[调度器验证] batch 160: 学习率=0.000692
epoch [7/25] batch [160/200] time 37.744 (19.004) data 37.506 (18.769) loss 0.0017 (0.3133) acc 100.0000 (91.2500) lr 6.9164e-04 eta 19:12:54
[调度器验证] batch 180: 学习率=0.000692
epoch [7/25] batch [180/200] time 42.461 (21.361) data 42.225 (21.126) loss 0.6050 (0.3226) acc 75.0000 (90.6944) lr 6.9164e-04 eta 21:28:48
[调度器验证] batch 200: 学习率=0.001729
epoch [7/25] batch [200/200] time 47.152 (23.718) data 46.918 (23.482) loss 1.1474 (0.3187) acc 75.0000 (90.7500) lr 1.7291e-03 eta 23:43:03
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1406}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-7
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000009
epoch [8/25] batch [20/200] time 4.711 (2.477) data 4.475 (2.242) loss 0.0089 (0.5034) acc 100.0000 (85.0000) lr 8.8814e-06 eta 2:27:48
[调度器验证] batch 40: 学习率=0.001876
epoch [8/25] batch [40/200] time 9.418 (4.828) data 9.180 (4.592) loss 0.0027 (0.4340) acc 100.0000 (88.1250) lr 1.8764e-03 eta 4:46:25
[调度器验证] batch 60: 学习率=0.000575
epoch [8/25] batch [60/200] time 14.127 (7.185) data 13.895 (6.950) loss 0.0065 (0.3965) acc 100.0000 (89.5833) lr 5.7493e-04 eta 7:03:54
[调度器验证] batch 80: 学习率=0.000813
epoch [8/25] batch [80/200] time 18.825 (9.535) data 18.587 (9.301) loss 0.0590 (0.3932) acc 100.0000 (87.8125) lr 8.1321e-04 eta 9:19:24
[调度器验证] batch 100: 学习率=0.001729
epoch [8/25] batch [100/200] time 23.544 (11.889) data 23.310 (11.654) loss 0.0086 (0.3805) acc 100.0000 (88.7500) lr 1.7291e-03 eta 11:33:30
[调度器验证] batch 120: 学习率=0.000009
epoch [8/25] batch [120/200] time 28.260 (14.244) data 28.025 (14.009) loss 0.5859 (0.3796) acc 75.0000 (88.9583) lr 8.8814e-06 eta 13:46:08
[调度器验证] batch 140: 学习率=0.001876
epoch [8/25] batch [140/200] time 32.968 (16.600) data 32.734 (16.365) loss 0.0095 (0.3377) acc 100.0000 (90.3571) lr 1.8764e-03 eta 15:57:14
[调度器验证] batch 160: 学习率=0.000575
epoch [8/25] batch [160/200] time 37.682 (18.954) data 37.435 (18.719) loss 0.3985 (0.3317) acc 75.0000 (90.4688) lr 5.7493e-04 eta 18:06:42
[调度器验证] batch 180: 学习率=0.000813
epoch [8/25] batch [180/200] time 42.354 (21.308) data 42.121 (21.073) loss 0.0091 (0.3228) acc 100.0000 (90.6944) lr 8.1321e-04 eta 20:14:33
[调度器验证] batch 200: 学习率=0.001638
epoch [8/25] batch [200/200] time 47.023 (23.658) data 46.788 (23.423) loss 0.0048 (0.3129) acc 100.0000 (91.1250) lr 1.6376e-03 eta 22:20:36
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1607}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-8
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000032
epoch [9/25] batch [20/200] time 4.664 (2.453) data 4.433 (2.220) loss 0.3399 (0.1761) acc 75.0000 (93.7500) lr 3.2401e-05 eta 2:18:10
[调度器验证] batch 40: 学习率=0.001930
epoch [9/25] batch [40/200] time 9.390 (4.800) data 9.151 (4.566) loss 0.1640 (0.2140) acc 100.0000 (92.5000) lr 1.9298e-03 eta 4:28:47
[调度器验证] batch 60: 学习率=0.000465
epoch [9/25] batch [60/200] time 14.102 (7.153) data 13.865 (6.918) loss 1.1657 (0.3273) acc 75.0000 (89.1667) lr 4.6494e-04 eta 6:38:11
[调度器验证] batch 80: 学习率=0.000938
epoch [9/25] batch [80/200] time 18.821 (9.510) data 18.585 (9.275) loss 0.0197 (0.3259) acc 100.0000 (90.0000) lr 9.3774e-04 eta 8:46:13
[调度器验证] batch 100: 学习率=0.001638
epoch [9/25] batch [100/200] time 23.554 (11.868) data 23.317 (11.633) loss 0.0021 (0.3101) acc 100.0000 (90.5000) lr 1.6376e-03 eta 10:52:45
[调度器验证] batch 120: 学习率=0.000032
epoch [9/25] batch [120/200] time 28.288 (14.231) data 28.052 (13.995) loss 0.1839 (0.3155) acc 100.0000 (90.4167) lr 3.2401e-05 eta 12:57:56
[调度器验证] batch 140: 学习率=0.001930
epoch [9/25] batch [140/200] time 32.993 (16.591) data 32.750 (16.356) loss 0.0010 (0.3170) acc 100.0000 (90.3571) lr 1.9298e-03 eta 15:01:26
[调度器验证] batch 160: 学习率=0.000465
epoch [9/25] batch [160/200] time 37.722 (18.951) data 37.484 (18.716) loss 0.4745 (0.3312) acc 75.0000 (90.0000) lr 4.6494e-04 eta 17:03:22
[调度器验证] batch 180: 学习率=0.000938
epoch [9/25] batch [180/200] time 42.483 (21.314) data 42.241 (21.078) loss 0.2371 (0.3199) acc 100.0000 (90.5556) lr 9.3774e-04 eta 19:03:51
[调度器验证] batch 200: 学习率=0.001536
epoch [9/25] batch [200/200] time 47.189 (23.678) data 46.951 (23.442) loss 1.4660 (0.3260) acc 75.0000 (90.3750) lr 1.5361e-03 eta 21:02:48
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1808}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-9
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000071
epoch [10/25] batch [20/200] time 4.700 (2.469) data 4.467 (2.235) loss 0.0122 (0.2342) acc 100.0000 (92.5000) lr 7.1188e-05 eta 2:10:52
[调度器验证] batch 40: 学习率=0.001969
epoch [10/25] batch [40/200] time 9.387 (4.815) data 9.152 (4.580) loss 0.0096 (0.2005) acc 100.0000 (93.1250) lr 1.9686e-03 eta 4:13:34
[调度器验证] batch 60: 学习率=0.000363
epoch [10/25] batch [60/200] time 14.094 (7.162) data 13.859 (6.928) loss 0.0137 (0.2572) acc 100.0000 (92.5000) lr 3.6339e-04 eta 6:14:49
[调度器验证] batch 80: 学习率=0.001063
epoch [10/25] batch [80/200] time 18.822 (9.517) data 18.586 (9.282) loss 0.2084 (0.3062) acc 100.0000 (91.5625) lr 1.0633e-03 eta 8:14:51
[调度器验证] batch 100: 学习率=0.001536
epoch [10/25] batch [100/200] time 23.520 (11.871) data 23.286 (11.636) loss 0.0449 (0.2863) acc 100.0000 (92.0000) lr 1.5361e-03 eta 10:13:20
[调度器验证] batch 120: 学习率=0.000071
epoch [10/25] batch [120/200] time 28.240 (14.227) data 28.006 (13.992) loss 1.2428 (0.2880) acc 75.0000 (92.2917) lr 7.1188e-05 eta 12:10:18
[调度器验证] batch 140: 学习率=0.001969
epoch [10/25] batch [140/200] time 32.932 (16.581) data 32.699 (16.346) loss 0.1676 (0.3028) acc 100.0000 (91.2500) lr 1.9686e-03 eta 14:05:37
[调度器验证] batch 160: 学习率=0.000363
epoch [10/25] batch [160/200] time 37.587 (18.931) data 37.356 (18.696) loss 0.0602 (0.3255) acc 100.0000 (90.9375) lr 3.6339e-04 eta 15:59:09
[调度器验证] batch 180: 学习率=0.001063
epoch [10/25] batch [180/200] time 42.240 (21.275) data 42.010 (21.041) loss 0.7285 (0.3383) acc 75.0000 (90.0000) lr 1.0633e-03 eta 17:50:51
[调度器验证] batch 200: 学习率=0.001426
epoch [10/25] batch [200/200] time 46.940 (23.618) data 46.703 (23.384) loss 0.1797 (0.3414) acc 100.0000 (89.7500) lr 1.4261e-03 eta 19:40:54
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2009}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-10
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000125
epoch [11/25] batch [20/200] time 4.714 (2.480) data 4.481 (2.245) loss 2.1357 (0.3395) acc 50.0000 (91.2500) lr 1.2463e-04 eta 2:03:10
[调度器验证] batch 40: 学习率=0.001992
epoch [11/25] batch [40/200] time 9.465 (4.845) data 9.228 (4.609) loss 0.1012 (0.3918) acc 100.0000 (91.2500) lr 1.9921e-03 eta 3:59:01
[调度器验证] batch 60: 学习率=0.000272
epoch [11/25] batch [60/200] time 14.182 (7.211) data 13.947 (6.975) loss 1.5158 (0.4005) acc 75.0000 (91.2500) lr 2.7190e-04 eta 5:53:19
[调度器验证] batch 80: 学习率=0.001188
epoch [11/25] batch [80/200] time 18.901 (9.572) data 18.660 (9.336) loss 0.0483 (0.3851) acc 100.0000 (90.9375) lr 1.1878e-03 eta 7:45:50
[调度器验证] batch 100: 学习率=0.001426
epoch [11/25] batch [100/200] time 23.631 (11.934) data 23.391 (11.698) loss 0.3118 (0.3565) acc 75.0000 (91.2500) lr 1.4261e-03 eta 9:36:48
[调度器验证] batch 120: 学习率=0.000125
epoch [11/25] batch [120/200] time 28.342 (14.294) data 28.100 (14.058) loss 0.0038 (0.3204) acc 100.0000 (92.0833) lr 1.2463e-04 eta 11:26:06
[调度器验证] batch 140: 学习率=0.001992
epoch [11/25] batch [140/200] time 33.067 (16.656) data 32.832 (16.420) loss 0.0514 (0.3368) acc 100.0000 (91.6071) lr 1.9921e-03 eta 13:13:55
[调度器验证] batch 160: 学习率=0.000272
epoch [11/25] batch [160/200] time 37.774 (19.016) data 37.538 (18.780) loss 0.5547 (0.3162) acc 75.0000 (92.1875) lr 2.7190e-04 eta 15:00:05
[调度器验证] batch 180: 学习率=0.001188
epoch [11/25] batch [180/200] time 42.491 (21.376) data 42.255 (21.140) loss 0.0300 (0.3312) acc 100.0000 (92.0833) lr 1.1878e-03 eta 16:44:39
[调度器验证] batch 200: 学习率=0.001309
epoch [11/25] batch [200/200] time 47.200 (23.734) data 46.961 (23.498) loss 0.0002 (0.3238) acc 100.0000 (92.0000) lr 1.3094e-03 eta 18:27:35
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2210}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-11
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000192
epoch [12/25] batch [20/200] time 4.711 (2.481) data 4.476 (2.246) loss 0.6461 (0.3481) acc 75.0000 (90.0000) lr 1.9189e-04 eta 1:54:58
[调度器验证] batch 40: 学习率=0.002000
epoch [12/25] batch [40/200] time 9.419 (4.832) data 9.184 (4.597) loss 0.0035 (0.4248) acc 100.0000 (88.1250) lr 2.0000e-03 eta 3:42:16
[调度器验证] batch 60: 学习率=0.000192
epoch [12/25] batch [60/200] time 14.127 (7.185) data 13.893 (6.950) loss 0.0058 (0.3714) acc 100.0000 (89.5833) lr 1.9189e-04 eta 5:28:06
[调度器验证] batch 80: 学习率=0.001309
epoch [12/25] batch [80/200] time 18.867 (9.544) data 18.629 (9.309) loss 0.0013 (0.3828) acc 100.0000 (89.0625) lr 1.3094e-03 eta 7:12:40
[调度器验证] batch 100: 学习率=0.001309
epoch [12/25] batch [100/200] time 23.579 (11.903) data 23.342 (11.668) loss 0.4437 (0.3618) acc 75.0000 (89.5000) lr 1.3094e-03 eta 8:55:38
[调度器验证] batch 120: 学习率=0.000192
epoch [12/25] batch [120/200] time 28.309 (14.265) data 28.078 (14.030) loss 0.0593 (0.3446) acc 100.0000 (90.0000) lr 1.9189e-04 eta 10:37:10
[调度器验证] batch 140: 学习率=0.002000
epoch [12/25] batch [140/200] time 32.988 (16.622) data 32.756 (16.387) loss 0.1094 (0.3229) acc 100.0000 (90.8929) lr 2.0000e-03 eta 12:16:55
[调度器验证] batch 160: 学习率=0.000192
epoch [12/25] batch [160/200] time 37.646 (18.974) data 37.416 (18.739) loss 0.0004 (0.3129) acc 100.0000 (90.9375) lr 1.9189e-04 eta 13:54:52
[调度器验证] batch 180: 学习率=0.001309
epoch [12/25] batch [180/200] time 42.456 (21.330) data 42.225 (21.095) loss 0.0028 (0.3041) acc 100.0000 (91.5278) lr 1.3094e-03 eta 15:31:24
[调度器验证] batch 200: 学习率=0.001188
epoch [12/25] batch [200/200] time 47.160 (23.690) data 46.926 (23.455) loss 1.2781 (0.2991) acc 75.0000 (91.3750) lr 1.1878e-03 eta 17:06:34
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2411}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-12
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000272
epoch [13/25] batch [20/200] time 4.712 (2.478) data 4.480 (2.243) loss 0.0931 (0.2884) acc 100.0000 (95.0000) lr 2.7190e-04 eta 1:46:34
[调度器验证] batch 40: 学习率=0.001992
epoch [13/25] batch [40/200] time 9.406 (4.826) data 9.173 (4.592) loss 2.3954 (0.2682) acc 50.0000 (94.3750) lr 1.9921e-03 eta 3:25:55
[调度器验证] batch 60: 学习率=0.000125
epoch [13/25] batch [60/200] time 14.113 (7.176) data 13.876 (6.941) loss 0.2813 (0.2599) acc 75.0000 (94.5833) lr 1.2463e-04 eta 5:03:46
[调度器验证] batch 80: 学习率=0.001426
epoch [13/25] batch [80/200] time 18.806 (9.525) data 18.572 (9.291) loss 0.0056 (0.2767) acc 100.0000 (93.7500) lr 1.4261e-03 eta 6:40:04
[调度器验证] batch 100: 学习率=0.001188
epoch [13/25] batch [100/200] time 23.496 (11.874) data 23.262 (11.639) loss 0.3692 (0.2768) acc 75.0000 (93.0000) lr 1.1878e-03 eta 8:14:44
[调度器验证] batch 120: 学习率=0.000272
epoch [13/25] batch [120/200] time 28.199 (14.223) data 27.964 (13.988) loss 0.0007 (0.2944) acc 100.0000 (92.2917) lr 2.7190e-04 eta 9:47:52
[调度器验证] batch 140: 学习率=0.001992
epoch [13/25] batch [140/200] time 32.899 (16.572) data 32.666 (16.337) loss 0.0280 (0.3289) acc 100.0000 (91.2500) lr 1.9921e-03 eta 11:19:27
[调度器验证] batch 160: 学习率=0.000125
epoch [13/25] batch [160/200] time 37.629 (18.923) data 37.389 (18.689) loss 0.0055 (0.3178) acc 100.0000 (91.4062) lr 1.2463e-04 eta 12:49:33
[调度器验证] batch 180: 学习率=0.001426
epoch [13/25] batch [180/200] time 42.359 (21.278) data 42.117 (21.043) loss 0.8833 (0.3301) acc 75.0000 (90.8333) lr 1.4261e-03 eta 14:18:12
[调度器验证] batch 200: 学习率=0.001063
epoch [13/25] batch [200/200] time 47.027 (23.631) data 46.794 (23.397) loss 0.4856 (0.3228) acc 75.0000 (90.7500) lr 1.0633e-03 eta 15:45:15
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2612}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-13
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000363
epoch [14/25] batch [20/200] time 4.693 (2.466) data 4.460 (2.231) loss 0.0064 (0.2828) acc 100.0000 (91.2500) lr 3.6339e-04 eta 1:37:48
[调度器验证] batch 40: 学习率=0.001969
epoch [14/25] batch [40/200] time 9.410 (4.815) data 9.175 (4.580) loss 0.1251 (0.2227) acc 100.0000 (94.3750) lr 1.9686e-03 eta 3:09:23
[调度器验证] batch 60: 学习率=0.000071
epoch [14/25] batch [60/200] time 14.120 (7.173) data 13.887 (6.938) loss 0.0133 (0.2384) acc 100.0000 (93.7500) lr 7.1188e-05 eta 4:39:45
[调度器验证] batch 80: 学习率=0.001536
epoch [14/25] batch [80/200] time 18.815 (9.527) data 18.583 (9.292) loss 1.4245 (0.2958) acc 75.0000 (92.1875) lr 1.5361e-03 eta 6:08:22
[调度器验证] batch 100: 学习率=0.001063
epoch [14/25] batch [100/200] time 23.492 (11.877) data 23.258 (11.642) loss 0.0592 (0.2636) acc 100.0000 (93.0000) lr 1.0633e-03 eta 7:35:16
[调度器验证] batch 120: 学习率=0.000363
epoch [14/25] batch [120/200] time 28.148 (14.220) data 27.914 (13.986) loss 0.0014 (0.2536) acc 100.0000 (93.1250) lr 3.6339e-04 eta 9:00:21
[调度器验证] batch 140: 学习率=0.001969
epoch [14/25] batch [140/200] time 32.846 (16.562) data 32.607 (16.328) loss 0.0143 (0.2432) acc 100.0000 (93.5714) lr 1.9686e-03 eta 10:23:49
[调度器验证] batch 160: 学习率=0.000071
epoch [14/25] batch [160/200] time 37.560 (18.907) data 37.326 (18.672) loss 0.0138 (0.2477) acc 100.0000 (93.7500) lr 7.1188e-05 eta 11:45:51
[调度器验证] batch 180: 学习率=0.001536
epoch [14/25] batch [180/200] time 42.294 (21.256) data 42.061 (21.021) loss 0.0005 (0.2730) acc 100.0000 (93.1944) lr 1.5361e-03 eta 13:06:27
[调度器验证] batch 200: 学习率=0.000938
epoch [14/25] batch [200/200] time 47.008 (23.607) data 46.768 (23.373) loss 2.8276 (0.2976) acc 75.0000 (92.7500) lr 9.3774e-04 eta 14:25:36
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2813}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-14
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000465
epoch [15/25] batch [20/200] time 4.691 (2.467) data 4.455 (2.233) loss 0.0207 (0.3469) acc 100.0000 (90.0000) lr 4.6494e-04 eta 1:29:38
[调度器验证] batch 40: 学习率=0.001930
epoch [15/25] batch [40/200] time 9.379 (4.808) data 9.146 (4.574) loss 0.1128 (0.2981) acc 100.0000 (90.6250) lr 1.9298e-03 eta 2:53:05
[调度器验证] batch 60: 学习率=0.000032
epoch [15/25] batch [60/200] time 14.074 (7.154) data 13.838 (6.920) loss 0.5140 (0.3072) acc 75.0000 (90.0000) lr 3.2401e-05 eta 4:15:09
[调度器验证] batch 80: 学习率=0.001638
epoch [15/25] batch [80/200] time 18.739 (9.497) data 18.508 (9.263) loss 0.1639 (0.3030) acc 100.0000 (90.6250) lr 1.6376e-03 eta 5:35:33
[调度器验证] batch 100: 学习率=0.000938
epoch [15/25] batch [100/200] time 23.427 (11.837) data 23.191 (11.603) loss 0.9627 (0.2828) acc 50.0000 (90.5000) lr 9.3774e-04 eta 6:54:18
[调度器验证] batch 120: 学习率=0.000465
epoch [15/25] batch [120/200] time 28.120 (14.179) data 27.884 (13.945) loss 0.3341 (0.2773) acc 100.0000 (90.8333) lr 4.6494e-04 eta 8:11:32
[调度器验证] batch 140: 学习率=0.001930
epoch [15/25] batch [140/200] time 33.140 (16.548) data 32.896 (16.312) loss 0.1733 (0.2828) acc 100.0000 (90.8929) lr 1.9298e-03 eta 9:28:08
[调度器验证] batch 160: 学习率=0.000032
epoch [15/25] batch [160/200] time 37.915 (18.936) data 37.679 (18.700) loss 0.0028 (0.2680) acc 100.0000 (91.4062) lr 3.2401e-05 eta 10:43:50
[调度器验证] batch 180: 学习率=0.001638
epoch [15/25] batch [180/200] time 42.634 (21.320) data 42.394 (21.084) loss 0.0116 (0.2677) acc 100.0000 (91.5278) lr 1.6376e-03 eta 11:57:47
[调度器验证] batch 200: 学习率=0.000813
epoch [15/25] batch [200/200] time 47.343 (23.699) data 47.106 (23.463) loss 0.3246 (0.2693) acc 75.0000 (91.3750) lr 8.1321e-04 eta 13:09:58
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3014}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-15
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000575
epoch [16/25] batch [20/200] time 4.720 (2.486) data 4.489 (2.250) loss 0.0273 (0.1687) acc 100.0000 (93.7500) lr 5.7493e-04 eta 1:22:01
[调度器验证] batch 40: 学习率=0.001876
epoch [16/25] batch [40/200] time 9.416 (4.836) data 9.183 (4.601) loss 0.0014 (0.1832) acc 100.0000 (93.1250) lr 1.8764e-03 eta 2:37:57
[调度器验证] batch 60: 学习率=0.000009
epoch [16/25] batch [60/200] time 14.130 (7.188) data 13.898 (6.953) loss 1.4324 (0.2453) acc 75.0000 (92.0833) lr 8.8814e-06 eta 3:52:24
[调度器验证] batch 80: 学习率=0.001729
epoch [16/25] batch [80/200] time 18.802 (9.536) data 18.569 (9.302) loss 0.2457 (0.2201) acc 75.0000 (92.8125) lr 1.7291e-03 eta 5:05:09
[调度器验证] batch 100: 学习率=0.000813
epoch [16/25] batch [100/200] time 23.460 (11.878) data 23.229 (11.644) loss 0.0348 (0.2408) acc 100.0000 (92.5000) lr 8.1321e-04 eta 6:16:09
[调度器验证] batch 120: 学习率=0.000575
epoch [16/25] batch [120/200] time 28.144 (14.217) data 27.904 (13.983) loss 0.6005 (0.2464) acc 75.0000 (92.5000) lr 5.7493e-04 eta 7:25:27
[调度器验证] batch 140: 学习率=0.001876
epoch [16/25] batch [140/200] time 32.944 (16.566) data 32.709 (16.331) loss 0.0451 (0.2328) acc 100.0000 (92.8571) lr 1.8764e-03 eta 8:33:33
[调度器验证] batch 160: 学习率=0.000009
epoch [16/25] batch [160/200] time 37.663 (18.923) data 37.426 (18.688) loss 0.0437 (0.2404) acc 100.0000 (92.5000) lr 8.8814e-06 eta 9:40:18
[调度器验证] batch 180: 学习率=0.001729
epoch [16/25] batch [180/200] time 42.407 (21.281) data 42.171 (21.046) loss 1.0395 (0.2343) acc 50.0000 (92.5000) lr 1.7291e-03 eta 10:45:31
[调度器验证] batch 200: 学习率=0.000692
epoch [16/25] batch [200/200] time 47.138 (23.643) data 46.905 (23.408) loss 0.1772 (0.2290) acc 100.0000 (92.8750) lr 6.9164e-04 eta 11:49:17
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3215}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-16
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000692
epoch [17/25] batch [20/200] time 4.742 (2.495) data 4.506 (2.259) loss 0.0161 (0.2443) acc 100.0000 (93.7500) lr 6.9164e-04 eta 1:14:01
[调度器验证] batch 40: 学习率=0.001809
epoch [17/25] batch [40/200] time 9.503 (4.866) data 9.264 (4.629) loss 0.0007 (0.2675) acc 100.0000 (91.8750) lr 1.8091e-03 eta 2:22:43
[调度器验证] batch 60: 学习率=0.000001
epoch [17/25] batch [60/200] time 14.206 (7.236) data 13.974 (7.000) loss 0.6515 (0.3241) acc 75.0000 (90.0000) lr 1.0000e-06 eta 3:29:50
[调度器验证] batch 80: 学习率=0.001809
epoch [17/25] batch [80/200] time 18.902 (9.596) data 18.667 (9.360) loss 0.0182 (0.2805) acc 100.0000 (91.8750) lr 1.8091e-03 eta 4:35:04
[调度器验证] batch 100: 学习率=0.000692
epoch [17/25] batch [100/200] time 23.596 (11.951) data 23.365 (11.715) loss 0.6815 (0.3384) acc 75.0000 (90.5000) lr 6.9164e-04 eta 5:38:36
[调度器验证] batch 120: 学习率=0.000692
epoch [17/25] batch [120/200] time 28.304 (14.303) data 28.070 (14.068) loss 0.0310 (0.3087) acc 100.0000 (91.4583) lr 6.9164e-04 eta 6:40:28
[调度器验证] batch 140: 学习率=0.001809
epoch [17/25] batch [140/200] time 33.015 (16.656) data 32.779 (16.421) loss 0.0229 (0.3125) acc 100.0000 (91.2500) lr 1.8091e-03 eta 7:40:49
[调度器验证] batch 160: 学习率=0.000001
epoch [17/25] batch [160/200] time 37.730 (19.011) data 37.491 (18.775) loss 0.0049 (0.3011) acc 100.0000 (91.5625) lr 1.0000e-06 eta 8:39:37
[调度器验证] batch 180: 学习率=0.001809
epoch [17/25] batch [180/200] time 42.463 (21.366) data 42.227 (21.131) loss 0.0322 (0.2926) acc 100.0000 (91.6667) lr 1.8091e-03 eta 9:36:53
[调度器验证] batch 200: 学习率=0.000575
epoch [17/25] batch [200/200] time 47.177 (23.723) data 46.943 (23.488) loss 0.0020 (0.2951) acc 100.0000 (91.5000) lr 5.7493e-04 eta 10:32:37
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3416}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-17
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000813
epoch [18/25] batch [20/200] time 4.699 (2.467) data 4.463 (2.233) loss 0.9636 (0.2641) acc 75.0000 (91.2500) lr 8.1321e-04 eta 1:04:58
[调度器验证] batch 40: 学习率=0.001729
epoch [18/25] batch [40/200] time 9.393 (4.819) data 9.162 (4.584) loss 0.0089 (0.2064) acc 100.0000 (93.7500) lr 1.7291e-03 eta 2:05:17
[调度器验证] batch 60: 学习率=0.000009
epoch [18/25] batch [60/200] time 14.057 (7.159) data 13.824 (6.926) loss 0.0185 (0.2026) acc 100.0000 (94.5833) lr 8.8814e-06 eta 3:03:45
[调度器验证] batch 80: 学习率=0.001876
epoch [18/25] batch [80/200] time 18.736 (9.498) data 18.503 (9.264) loss 0.1923 (0.1934) acc 100.0000 (95.0000) lr 1.8764e-03 eta 4:00:36
[调度器验证] batch 100: 学习率=0.000575
epoch [18/25] batch [100/200] time 23.443 (11.840) data 23.208 (11.606) loss 0.2797 (0.2114) acc 75.0000 (94.5000) lr 5.7493e-04 eta 4:55:59
[调度器验证] batch 120: 学习率=0.000813
epoch [18/25] batch [120/200] time 28.153 (14.187) data 27.919 (13.953) loss 0.6721 (0.2492) acc 75.0000 (93.1250) lr 8.1321e-04 eta 5:49:56
[调度器验证] batch 140: 学习率=0.001729
epoch [18/25] batch [140/200] time 32.866 (16.536) data 32.630 (16.302) loss 0.0225 (0.2391) acc 100.0000 (93.2143) lr 1.7291e-03 eta 6:42:22
[调度器验证] batch 160: 学习率=0.000009
epoch [18/25] batch [160/200] time 37.577 (18.886) data 37.342 (18.652) loss 0.3606 (0.2617) acc 75.0000 (92.3438) lr 8.8814e-06 eta 7:33:16
[调度器验证] batch 180: 学习率=0.001876
epoch [18/25] batch [180/200] time 42.393 (21.244) data 42.161 (21.009) loss 1.1414 (0.2557) acc 75.0000 (92.7778) lr 1.8764e-03 eta 8:22:46
[调度器验证] batch 200: 学习率=0.000465
epoch [18/25] batch [200/200] time 47.076 (23.605) data 46.844 (23.370) loss 0.0992 (0.2661) acc 100.0000 (92.1250) lr 4.6494e-04 eta 9:10:46
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3617}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-18
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000938
epoch [19/25] batch [20/200] time 4.702 (2.474) data 4.466 (2.240) loss 0.0152 (0.1154) acc 100.0000 (97.5000) lr 9.3774e-04 eta 0:56:54
[调度器验证] batch 40: 学习率=0.001638
epoch [19/25] batch [40/200] time 9.379 (4.818) data 9.145 (4.584) loss 0.0029 (0.2099) acc 100.0000 (95.0000) lr 1.6376e-03 eta 1:49:13
[调度器验证] batch 60: 学习率=0.000032
epoch [19/25] batch [60/200] time 14.069 (7.160) data 13.837 (6.926) loss 0.3358 (0.2140) acc 75.0000 (94.5833) lr 3.2401e-05 eta 2:39:54
[调度器验证] batch 80: 学习率=0.001930
epoch [19/25] batch [80/200] time 18.749 (9.502) data 18.518 (9.268) loss 0.1796 (0.2826) acc 100.0000 (93.4375) lr 1.9298e-03 eta 3:29:02
[调度器验证] batch 100: 学习率=0.000465
epoch [19/25] batch [100/200] time 23.438 (11.843) data 23.202 (11.609) loss 0.1170 (0.2814) acc 100.0000 (93.2500) lr 4.6494e-04 eta 4:16:35
[调度器验证] batch 120: 学习率=0.000938
epoch [19/25] batch [120/200] time 28.137 (14.186) data 27.903 (13.952) loss 0.0839 (0.2559) acc 100.0000 (93.7500) lr 9.3774e-04 eta 5:02:38
[调度器验证] batch 140: 学习率=0.001638
epoch [19/25] batch [140/200] time 32.842 (16.531) data 32.606 (16.297) loss 0.1380 (0.2609) acc 100.0000 (93.3929) lr 1.6376e-03 eta 5:47:08
[调度器验证] batch 160: 学习率=0.000032
epoch [19/25] batch [160/200] time 37.542 (18.879) data 37.310 (18.645) loss 0.5908 (0.2543) acc 75.0000 (93.2812) lr 3.2401e-05 eta 6:30:09
[调度器验证] batch 180: 学习率=0.001930
epoch [19/25] batch [180/200] time 42.250 (21.227) data 42.020 (20.993) loss 0.1364 (0.2628) acc 100.0000 (93.0556) lr 1.9298e-03 eta 7:11:37
[调度器验证] batch 200: 学习率=0.000363
epoch [19/25] batch [200/200] time 46.944 (23.576) data 46.712 (23.342) loss 0.2275 (0.2647) acc 100.0000 (92.7500) lr 3.6339e-04 eta 7:51:31
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3818}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-19
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001063
epoch [20/25] batch [20/200] time 4.673 (2.462) data 4.440 (2.228) loss 0.5211 (0.2701) acc 100.0000 (92.5000) lr 1.0633e-03 eta 0:48:24
[调度器验证] batch 40: 学习率=0.001536
epoch [20/25] batch [40/200] time 9.312 (4.785) data 9.079 (4.552) loss 0.9905 (0.3532) acc 75.0000 (90.6250) lr 1.5361e-03 eta 1:32:30
[调度器验证] batch 60: 学习率=0.000071
epoch [20/25] batch [60/200] time 13.978 (7.109) data 13.744 (6.877) loss 0.2575 (0.2894) acc 100.0000 (92.5000) lr 7.1188e-05 eta 2:15:04
[调度器验证] batch 80: 学习率=0.001969
epoch [20/25] batch [80/200] time 18.680 (9.444) data 18.445 (9.211) loss 0.0037 (0.2595) acc 100.0000 (92.8125) lr 1.9686e-03 eta 2:56:17
[调度器验证] batch 100: 学习率=0.000363
epoch [20/25] batch [100/200] time 23.361 (11.783) data 23.127 (11.550) loss 0.3495 (0.2864) acc 100.0000 (92.2500) lr 3.6339e-04 eta 3:36:01
[调度器验证] batch 120: 学习率=0.001063
epoch [20/25] batch [120/200] time 28.035 (14.122) data 27.803 (13.889) loss 0.0568 (0.2564) acc 100.0000 (92.9167) lr 1.0633e-03 eta 4:14:11
[调度器验证] batch 140: 学习率=0.001536
epoch [20/25] batch [140/200] time 32.746 (16.463) data 32.512 (16.229) loss 1.0429 (0.2694) acc 75.0000 (92.1429) lr 1.5361e-03 eta 4:50:50
[调度器验证] batch 160: 学习率=0.000071
epoch [20/25] batch [160/200] time 37.443 (18.807) data 37.211 (18.573) loss 0.0240 (0.2799) acc 100.0000 (92.1875) lr 7.1188e-05 eta 5:25:58
[调度器验证] batch 180: 学习率=0.001969
epoch [20/25] batch [180/200] time 42.133 (21.151) data 41.895 (20.917) loss 0.0397 (0.2830) acc 100.0000 (92.0833) lr 1.9686e-03 eta 5:59:33
[调度器验证] batch 200: 学习率=0.000272
epoch [20/25] batch [200/200] time 46.831 (23.495) data 46.596 (23.262) loss 0.7937 (0.2821) acc 75.0000 (91.6250) lr 2.7190e-04 eta 6:31:35
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4019}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-20
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001188
epoch [21/25] batch [20/200] time 4.680 (2.454) data 4.443 (2.221) loss 0.8692 (0.2695) acc 75.0000 (92.5000) lr 1.1878e-03 eta 0:40:05
[调度器验证] batch 40: 学习率=0.001426
epoch [21/25] batch [40/200] time 9.375 (4.798) data 9.144 (4.565) loss 0.4821 (0.2806) acc 75.0000 (93.1250) lr 1.4261e-03 eta 1:16:46
[调度器验证] batch 60: 学习率=0.000125
epoch [21/25] batch [60/200] time 14.086 (7.150) data 13.853 (6.916) loss 0.0310 (0.3150) acc 100.0000 (92.5000) lr 1.2463e-04 eta 1:52:00
[调度器验证] batch 80: 学习率=0.001992
epoch [21/25] batch [80/200] time 18.780 (9.501) data 18.547 (9.266) loss 0.0016 (0.2912) acc 100.0000 (92.5000) lr 1.9921e-03 eta 2:25:40
[调度器验证] batch 100: 学习率=0.000272
epoch [21/25] batch [100/200] time 23.486 (11.851) data 23.251 (11.616) loss 1.5356 (0.2888) acc 75.0000 (92.5000) lr 2.7190e-04 eta 2:57:45
[调度器验证] batch 120: 学习率=0.001188
epoch [21/25] batch [120/200] time 28.174 (14.200) data 27.941 (13.966) loss 1.8074 (0.3062) acc 25.0000 (91.6667) lr 1.1878e-03 eta 3:28:16
[调度器验证] batch 140: 学习率=0.001426
epoch [21/25] batch [140/200] time 32.877 (16.549) data 32.645 (16.315) loss 0.1667 (0.3045) acc 100.0000 (91.6071) lr 1.4261e-03 eta 3:57:12
[调度器验证] batch 160: 学习率=0.000125
epoch [21/25] batch [160/200] time 37.585 (18.900) data 37.351 (18.665) loss 0.0458 (0.2955) acc 100.0000 (92.1875) lr 1.2463e-04 eta 4:24:35
[调度器验证] batch 180: 学习率=0.001992
epoch [21/25] batch [180/200] time 42.268 (21.249) data 42.036 (21.015) loss 0.8844 (0.2821) acc 75.0000 (92.5000) lr 1.9921e-03 eta 4:50:24
[调度器验证] batch 200: 学习率=0.000192
epoch [21/25] batch [200/200] time 46.931 (23.596) data 46.700 (23.362) loss 0.0569 (0.2811) acc 100.0000 (92.2500) lr 1.9189e-04 eta 5:14:36
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4220}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-21
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001309
epoch [22/25] batch [20/200] time 4.665 (2.454) data 4.435 (2.221) loss 0.1448 (0.2533) acc 100.0000 (91.2500) lr 1.3094e-03 eta 0:31:53
[调度器验证] batch 40: 学习率=0.001309
epoch [22/25] batch [40/200] time 9.338 (4.783) data 9.105 (4.550) loss 0.0036 (0.2191) acc 100.0000 (92.5000) lr 1.3094e-03 eta 1:00:35
[调度器验证] batch 60: 学习率=0.000192
epoch [22/25] batch [60/200] time 14.037 (7.125) data 13.802 (6.891) loss 0.8300 (0.2343) acc 75.0000 (92.5000) lr 1.9189e-04 eta 1:27:52
[调度器验证] batch 80: 学习率=0.002000
epoch [22/25] batch [80/200] time 18.741 (9.472) data 18.507 (9.238) loss 0.2120 (0.2771) acc 75.0000 (91.5625) lr 2.0000e-03 eta 1:53:39
[调度器验证] batch 100: 学习率=0.000192
epoch [22/25] batch [100/200] time 23.460 (11.821) data 23.220 (11.587) loss 0.2410 (0.3120) acc 100.0000 (91.2500) lr 1.9189e-04 eta 2:17:54
[调度器验证] batch 120: 学习率=0.001309
epoch [22/25] batch [120/200] time 28.150 (14.173) data 27.921 (13.938) loss 0.0026 (0.3056) acc 100.0000 (91.6667) lr 1.3094e-03 eta 2:40:37
[调度器验证] batch 140: 学习率=0.001309
epoch [22/25] batch [140/200] time 32.866 (16.524) data 32.631 (16.289) loss 1.3624 (0.2934) acc 50.0000 (91.9643) lr 1.3094e-03 eta 3:01:45
[调度器验证] batch 160: 学习率=0.000192
epoch [22/25] batch [160/200] time 37.558 (18.875) data 37.322 (18.640) loss 0.0010 (0.2932) acc 100.0000 (91.8750) lr 1.9189e-04 eta 3:21:19
[调度器验证] batch 180: 学习率=0.002000
epoch [22/25] batch [180/200] time 42.271 (21.226) data 42.040 (20.992) loss 0.1792 (0.2843) acc 100.0000 (91.9444) lr 2.0000e-03 eta 3:39:20
[调度器验证] batch 200: 学习率=0.000125
epoch [22/25] batch [200/200] time 46.960 (23.577) data 46.726 (23.343) loss 0.0012 (0.2770) acc 100.0000 (92.0000) lr 1.2463e-04 eta 3:55:46
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4421}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-22
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001426
epoch [23/25] batch [20/200] time 4.699 (2.466) data 4.465 (2.231) loss 0.0023 (0.1850) acc 100.0000 (95.0000) lr 1.4261e-03 eta 0:23:50
[调度器验证] batch 40: 学习率=0.001188
epoch [23/25] batch [40/200] time 9.399 (4.817) data 9.166 (4.583) loss 0.0056 (0.1587) acc 100.0000 (95.6250) lr 1.1878e-03 eta 0:44:57
[调度器验证] batch 60: 学习率=0.000272
epoch [23/25] batch [60/200] time 14.115 (7.169) data 13.882 (6.935) loss 0.0332 (0.1724) acc 100.0000 (96.2500) lr 2.7190e-04 eta 1:04:31
[调度器验证] batch 80: 学习率=0.001992
epoch [23/25] batch [80/200] time 18.824 (9.525) data 18.590 (9.290) loss 0.0352 (0.1493) acc 100.0000 (96.5625) lr 1.9921e-03 eta 1:22:32
[调度器验证] batch 100: 学习率=0.000125
epoch [23/25] batch [100/200] time 23.519 (11.877) data 23.287 (11.643) loss 0.0029 (0.1373) acc 100.0000 (96.7500) lr 1.2463e-04 eta 1:38:58
[调度器验证] batch 120: 学习率=0.001426
epoch [23/25] batch [120/200] time 28.253 (14.232) data 28.016 (13.997) loss 0.0482 (0.1468) acc 100.0000 (96.8750) lr 1.4261e-03 eta 1:53:51
[调度器验证] batch 140: 学习率=0.001188
epoch [23/25] batch [140/200] time 32.986 (16.589) data 32.748 (16.354) loss 0.0397 (0.1433) acc 100.0000 (96.7857) lr 1.1878e-03 eta 2:07:11
[调度器验证] batch 160: 学习率=0.000272
epoch [23/25] batch [160/200] time 37.695 (18.949) data 37.461 (18.714) loss 0.0013 (0.1531) acc 100.0000 (96.0938) lr 2.7190e-04 eta 2:18:57
[调度器验证] batch 180: 学习率=0.001992
epoch [23/25] batch [180/200] time 42.369 (21.304) data 42.134 (21.069) loss 0.1119 (0.1509) acc 100.0000 (96.1111) lr 1.9921e-03 eta 2:29:07
[调度器验证] batch 200: 学习率=0.000071
epoch [23/25] batch [200/200] time 47.054 (23.656) data 46.816 (23.422) loss 0.9933 (0.1563) acc 75.0000 (96.0000) lr 7.1188e-05 eta 2:37:42
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4622}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-23
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001536
epoch [24/25] batch [20/200] time 4.731 (2.483) data 4.496 (2.247) loss 0.0392 (0.1736) acc 100.0000 (93.7500) lr 1.5361e-03 eta 0:15:43
[调度器验证] batch 40: 学习率=0.001063
epoch [24/25] batch [40/200] time 9.481 (4.857) data 9.241 (4.620) loss 0.2523 (0.2059) acc 100.0000 (92.5000) lr 1.0633e-03 eta 0:29:08
[调度器验证] batch 60: 学习率=0.000363
epoch [24/25] batch [60/200] time 14.179 (7.219) data 13.946 (6.984) loss 0.5079 (0.1885) acc 75.0000 (93.7500) lr 3.6339e-04 eta 0:40:54
[调度器验证] batch 80: 学习率=0.001969
epoch [24/25] batch [80/200] time 18.893 (9.578) data 18.657 (9.343) loss 0.0020 (0.1705) acc 100.0000 (94.6875) lr 1.9686e-03 eta 0:51:05
[调度器验证] batch 100: 学习率=0.000071
epoch [24/25] batch [100/200] time 23.601 (11.935) data 23.365 (11.700) loss 0.0012 (0.1779) acc 100.0000 (94.2500) lr 7.1188e-05 eta 0:59:40
[调度器验证] batch 120: 学习率=0.001536
epoch [24/25] batch [120/200] time 28.319 (14.292) data 28.086 (14.056) loss 0.0025 (0.1746) acc 100.0000 (94.5833) lr 1.5361e-03 eta 1:06:41
[调度器验证] batch 140: 学习率=0.001063
epoch [24/25] batch [140/200] time 33.036 (16.650) data 32.805 (16.415) loss 0.0070 (0.1742) acc 100.0000 (94.8214) lr 1.0633e-03 eta 1:12:09
[调度器验证] batch 160: 学习率=0.000363
epoch [24/25] batch [160/200] time 37.749 (19.008) data 37.513 (18.773) loss 0.1758 (0.1843) acc 100.0000 (94.8438) lr 3.6339e-04 eta 1:16:01
[调度器验证] batch 180: 学习率=0.001969
epoch [24/25] batch [180/200] time 42.558 (21.369) data 42.320 (21.133) loss 0.3963 (0.1918) acc 100.0000 (94.5833) lr 1.9686e-03 eta 1:18:21
[调度器验证] batch 200: 学习率=0.000032
epoch [24/25] batch [200/200] time 47.261 (23.735) data 47.025 (23.499) loss 0.0027 (0.2039) acc 100.0000 (94.0000) lr 3.2401e-05 eta 1:19:06
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4823}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-24
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001638
epoch [25/25] batch [20/200] time 4.696 (2.463) data 4.463 (2.229) loss 0.0551 (0.1723) acc 100.0000 (93.7500) lr 1.6376e-03 eta 0:07:23
[调度器验证] batch 40: 学习率=0.000938
epoch [25/25] batch [40/200] time 9.381 (4.807) data 9.150 (4.573) loss 0.0011 (0.1529) acc 100.0000 (95.6250) lr 9.3774e-04 eta 0:12:49
[调度器验证] batch 60: 学习率=0.000465
epoch [25/25] batch [60/200] time 14.088 (7.153) data 13.853 (6.919) loss 0.0062 (0.1854) acc 100.0000 (95.0000) lr 4.6494e-04 eta 0:16:41
[调度器验证] batch 80: 学习率=0.001930
epoch [25/25] batch [80/200] time 18.836 (9.510) data 18.603 (9.275) loss 0.0082 (0.2308) acc 100.0000 (95.0000) lr 1.9298e-03 eta 0:19:01
[调度器验证] batch 100: 学习率=0.000032
epoch [25/25] batch [100/200] time 23.618 (11.877) data 23.380 (11.641) loss 0.3840 (0.2363) acc 75.0000 (94.5000) lr 3.2401e-05 eta 0:19:47
[调度器验证] batch 120: 学习率=0.001638
epoch [25/25] batch [120/200] time 28.327 (14.247) data 28.096 (14.011) loss 0.0045 (0.2199) acc 100.0000 (95.0000) lr 1.6376e-03 eta 0:18:59
[调度器验证] batch 140: 学习率=0.000938
epoch [25/25] batch [140/200] time 32.968 (16.606) data 32.738 (16.371) loss 0.7854 (0.2477) acc 75.0000 (93.9286) lr 9.3774e-04 eta 0:16:36
[调度器验证] batch 160: 学习率=0.000465
epoch [25/25] batch [160/200] time 37.612 (18.956) data 37.380 (18.722) loss 0.0181 (0.2384) acc 100.0000 (94.0625) lr 4.6494e-04 eta 0:12:38
[调度器验证] batch 180: 学习率=0.001930
epoch [25/25] batch [180/200] time 42.270 (21.301) data 42.039 (21.066) loss 0.3095 (0.2498) acc 100.0000 (93.7500) lr 1.9298e-03 eta 0:07:06
[调度器验证] batch 200: 学习率=0.000009
epoch [25/25] batch [200/200] time 46.965 (23.645) data 46.733 (23.410) loss 1.0063 (0.2806) acc 75.0000 (93.1250) lr 8.8814e-06 eta 0:00:00
保存调度器 prompt_learner 的手动状态: {'last_epoch': 5024}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_25/seed3/prompt_learner/model.pth.tar-25
训练完成
加载最后一轮模型
=== 验证类别列表 ===

在 *test* 集上评估
=> result
* total: 1,549
* correct: 1,493
* accuracy: 96.385%
* error: 3.62%
* macro_f1: 93.86%
耗时: 0:20:11
