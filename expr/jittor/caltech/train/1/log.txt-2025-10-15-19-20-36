***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['TRAINER.COOP.N_CTX', '4', 'TRAINER.COOP.CSC', 'False', 'TRAINER.COOP.CLASS_TOKEN_POSITION', 'end', 'DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base', 'TRAINER.ATPROMPT.USE_ATPROMPT', 'True', 'TRAINER.ATPROMPT.N_ATT1', '4', 'TRAINER.ATPROMPT.N_ATT2', '4', 'TRAINER.ATPROMPT.N_ATT3', '4', 'OPTIM.MAX_EPOCH', '30', 'TRAIN.CHECKPOINT_FREQ', '1']
output_dir: output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1
resume: 
root: /root/prompt_dataset
seed: 1
source_domains: None
target_domains: None
trainer: CoOp_ATP
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 4
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 4
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: Caltech101
  NUM_LABELED: -1
  NUM_SHOTS: 16
  ROOT: /root/prompt_dataset
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 30
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 1
  COUNT_ITER: train_x
  PRINT_FREQ: 20
TRAINER:
  ATPROMPT:
    ATT1_TEXT: shape
    ATT2_TEXT: size
    ATT3_TEXT: none
    ATT_NUM: 2
    N_ATT1: 4
    N_ATT2: 4
    N_ATT3: 4
    USE_ATPROMPT: True
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: False
    N_CTX: 4
    PREC: fp16
    W: 2.0
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FILM:
    LINEAR_PROBE: True
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  IVLP:
    CTX_INIT: a photo of a
    IMG_WEIGHT: 0.5
    N_CTX_TEXT: 2
    N_CTX_VISION: 2
    PREC: fp16
    PROMPT_DEPTH_TEXT: 9
    PROMPT_DEPTH_VISION: 9
  LINEAR_PROBE:
    TEST_TIME_FUSION: True
    TYPE: linear
    WEIGHT: 0.7
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MAPLE:
    CTX_INIT: a photo of a
    N_CTX: 2
    PREC: fp16
    PROMPT_DEPTH: 9
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp_ATP
  NAMES_TO_UPDATE: ['prompt_learner', 'linear_probe', 'film']
  PROMPTSRC:
    CTX_INIT: 
    GPA_MEAN: 15
    GPA_STD: 1
    IMAGE_LOSS_WEIGHT: 10
    N_CTX_TEXT: 4
    N_CTX_VISION: 4
    PREC: fp16
    PROMPT_DEPTH_TEXT: 9
    PROMPT_DEPTH_VISION: 9
    TEXT_LOSS_WEIGHT: 25
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Loading trainer: CoOp_ATP

=== DATALOADER DUMP (test) ===
cfg.DATASET.NAME: Caltech101
cfg.DATASET.SUBSAMPLE_CLASSES: base
cfg.DATASET.NUM_SHOTS: 16
cfg.INPUT.SIZE: (224, 224)
No loader found for test

=== DATALOADER DUMP (train) ===
cfg.DATASET.NAME: Caltech101
cfg.DATASET.SUBSAMPLE_CLASSES: base
cfg.DATASET.NUM_SHOTS: 16
cfg.INPUT.SIZE: (224, 224)
No loader found for train
=== 开始执行 build_data_loader，准备统计样本数 ===
Loading dataset: Caltech101
Reading split from /root/prompt_dataset/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /root/prompt_dataset/caltech-101/split_fewshot/shot_16-seed_1.pkl
当前 SUBSAMPLE_CLASSES 配置: base
SUBSAMPLE BASE CLASSES!
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
Jittor ListDataset 包装后长度: 800, 原始列表长度: 800
Jittor 修复：采样器总样本数=800, batch_size=4
Jittor 修复：正确的 batch 数（total_len）=200
Jittor ListDataset 包装后长度: 200, 原始列表长度: 200
Jittor 修复：采样器总样本数=200, batch_size=4
Jittor 修复：正确的 batch 数（total_len）=50
Jittor ListDataset 包装后长度: 1549, 原始列表长度: 1549
Jittor 修复：采样器总样本数=1549, batch_size=4
Jittor 修复：正确的 batch 数（total_len）=387

===== 数据集原始长度信息 =====
测试集原始长度 (len(dataset.test)): 1549
训练集原始长度 (len(dataset.train_x)): 800
类别数: 50
SUBSAMPLE_CLASSES 配置: base
=============================

统计样本数时出错: 'list' object has no attribute 'data_list'
train_loader_x 的 batch 数: 200
单个 batch 样本数: 4
train_loader_x 总样本数（batch数 × batch_size）: 800
train_loader_x.dataset 长度: 200
Loading CLIP (backbone: ViT-B/16)
Initializing a generic context
self.use_atp is True
self.atp_num is 2
Initial context: "X X X X"
Number of context words (tokens): 4
USE ATPROPMT-ING 1
['X X X X shape X X X X size X X X X face.', 'X X X X shape X X X X size X X X X leopard.', 'X X X X shape X X X X size X X X X motorbike.', 'X X X X shape X X X X size X X X X accordion.', 'X X X X shape X X X X size X X X X airplane.', 'X X X X shape X X X X size X X X X anchor.', 'X X X X shape X X X X size X X X X ant.', 'X X X X shape X X X X size X X X X barrel.', 'X X X X shape X X X X size X X X X bass.', 'X X X X shape X X X X size X X X X beaver.', 'X X X X shape X X X X size X X X X binocular.', 'X X X X shape X X X X size X X X X bonsai.', 'X X X X shape X X X X size X X X X brain.', 'X X X X shape X X X X size X X X X brontosaurus.', 'X X X X shape X X X X size X X X X buddha.', 'X X X X shape X X X X size X X X X butterfly.', 'X X X X shape X X X X size X X X X camera.', 'X X X X shape X X X X size X X X X cannon.', 'X X X X shape X X X X size X X X X car side.', 'X X X X shape X X X X size X X X X ceiling fan.', 'X X X X shape X X X X size X X X X cellphone.', 'X X X X shape X X X X size X X X X chair.', 'X X X X shape X X X X size X X X X chandelier.', 'X X X X shape X X X X size X X X X cougar body.', 'X X X X shape X X X X size X X X X cougar face.', 'X X X X shape X X X X size X X X X crab.', 'X X X X shape X X X X size X X X X crayfish.', 'X X X X shape X X X X size X X X X crocodile.', 'X X X X shape X X X X size X X X X crocodile head.', 'X X X X shape X X X X size X X X X cup.', 'X X X X shape X X X X size X X X X dalmatian.', 'X X X X shape X X X X size X X X X dollar bill.', 'X X X X shape X X X X size X X X X dolphin.', 'X X X X shape X X X X size X X X X dragonfly.', 'X X X X shape X X X X size X X X X electric guitar.', 'X X X X shape X X X X size X X X X elephant.', 'X X X X shape X X X X size X X X X emu.', 'X X X X shape X X X X size X X X X euphonium.', 'X X X X shape X X X X size X X X X ewer.', 'X X X X shape X X X X size X X X X ferry.', 'X X X X shape X X X X size X X X X flamingo.', 'X X X X shape X X X X size X X X X flamingo head.', 'X X X X shape X X X X size X X X X garfield.', 'X X X X shape X X X X size X X X X gerenuk.', 'X X X X shape X X X X size X X X X gramophone.', 'X X X X shape X X X X size X X X X grand piano.', 'X X X X shape X X X X size X X X X hawksbill.', 'X X X X shape X X X X size X X X X headphone.', 'X X X X shape X X X X size X X X X hedgehog.', 'X X X X shape X X X X size X X X X helicopter.']
embedding shape is [50,77,512,]
USE ATPROPMT-ING 2

===== 开始构建优化器 =====
优化器类型: sgd
学习率 (LR): 0.002
权重衰减 (WEIGHT_DECAY): 0.0005
是否启用分段学习率 (staged_lr): False
支持的优化器列表: ['adam', 'amsgrad', 'sgd', 'rmsprop', 'radam', 'adamw']
参数组 (param_groups) 为None，开始自动构建参数组...
不启用分段学习率，使用模型所有参数...
参数组总参数数量: 9

开始初始化优化器: sgd
SGD参数 - 学习率: 0.002, 动量: 0.9, 权重衰减: 0.0005
优化器构建成功: SGD
===== 优化器构建结束 =====

用与PyTorch对齐的预处理构建数据加载器
=== 开始执行 build_data_loader，准备统计样本数 ===
Loading dataset: Caltech101
Reading split from /root/prompt_dataset/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /root/prompt_dataset/caltech-101/split_fewshot/shot_16-seed_1.pkl
当前 SUBSAMPLE_CLASSES 配置: base
SUBSAMPLE BASE CLASSES!
Jittor ListDataset 包装后长度: 800, 原始列表长度: 800
Jittor 修复：采样器总样本数=800, batch_size=4
Jittor 修复：正确的 batch 数（total_len）=200
Jittor ListDataset 包装后长度: 200, 原始列表长度: 200
Jittor 修复：采样器总样本数=200, batch_size=4
Jittor 修复：正确的 batch 数（total_len）=50
Jittor ListDataset 包装后长度: 1549, 原始列表长度: 1549
Jittor 修复：采样器总样本数=1549, batch_size=4
Jittor 修复：正确的 batch 数（total_len）=387

===== 数据集原始长度信息 =====
测试集原始长度 (len(dataset.test)): 1549
训练集原始长度 (len(dataset.train_x)): 800
类别数: 50
SUBSAMPLE_CLASSES 配置: base
=============================

统计样本数时出错: 'list' object has no attribute 'data_list'
train_loader_x 的 batch 数: 200
单个 batch 样本数: 4
train_loader_x 总样本数（batch数 × batch_size）: 800
train_loader_x.dataset 长度: 200
Loading evaluator: Classification
未找到 checkpoint，从头训练
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000594
epoch [1/30] batch [20/200] time 165.165 (162.688) data 164.931 (155.080) loss 0.6810 (1.0336) acc 75.0000 (73.7500) lr 5.9397e-04 eta 11 days, 6:14:36
[调度器验证] batch 40: 学习率=0.000413
epoch [1/30] batch [40/200] time 169.865 (165.164) data 169.633 (161.242) loss 0.1851 (1.1745) acc 100.0000 (70.6250) lr 4.1301e-04 eta 11 days, 9:26:15
[调度器验证] batch 60: 学习率=0.001995
epoch [1/30] batch [60/200] time 174.566 (167.553) data 174.333 (164.860) loss 0.2956 (1.1910) acc 75.0000 (71.2500) lr 1.9945e-03 eta 11 days, 12:27:43
[调度器验证] batch 80: 学习率=0.000594
epoch [1/30] batch [80/200] time 179.316 (169.929) data 179.081 (167.851) loss 0.5724 (1.1748) acc 100.0000 (72.5000) lr 5.9397e-04 eta 11 days, 15:26:20
[调度器验证] batch 100: 学习率=0.000413
epoch [1/30] batch [100/200] time 184.026 (172.301) data 183.790 (170.591) loss 0.8350 (1.1622) acc 75.0000 (72.7500) lr 4.1301e-04 eta 11 days, 18:22:53
[调度器验证] batch 120: 学习率=0.001995
epoch [1/30] batch [120/200] time 188.765 (174.670) data 188.530 (173.206) loss 0.2897 (1.0846) acc 75.0000 (74.1667) lr 1.9945e-03 eta 11 days, 21:17:39
[调度器验证] batch 140: 学习率=0.000594
epoch [1/30] batch [140/200] time 193.495 (177.039) data 193.261 (175.750) loss 0.6941 (1.0671) acc 75.0000 (74.4643) lr 5.9397e-04 eta 12 days, 0:10:46
[调度器验证] batch 160: 学习率=0.000413
epoch [1/30] batch [160/200] time 198.248 (179.407) data 198.002 (178.249) loss 0.9704 (1.0581) acc 75.0000 (74.2188) lr 4.1301e-04 eta 12 days, 3:02:16
[调度器验证] batch 180: 学习率=0.001995
epoch [1/30] batch [180/200] time 202.997 (181.778) data 202.762 (180.723) loss 0.1064 (1.0034) acc 100.0000 (75.4167) lr 1.9945e-03 eta 12 days, 5:52:26
[调度器验证] batch 200: 学习率=0.000501
epoch [1/30] batch [200/200] time 207.761 (184.149) data 207.515 (183.176) loss 0.9344 (0.9818) acc 75.0000 (75.5000) lr 5.0075e-04 eta 12 days, 8:41:05
保存调度器 prompt_learner 的手动状态: {'last_epoch': 200}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-1
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000501
epoch [2/30] batch [20/200] time 4.763 (2.500) data 4.523 (2.263) loss 0.0421 (0.4431) acc 100.0000 (88.7500) lr 5.0075e-04 eta 4:00:51
[调度器验证] batch 40: 学习率=0.002000
epoch [2/30] batch [40/200] time 9.511 (4.878) data 9.275 (4.640) loss 1.7351 (0.4526) acc 50.0000 (86.2500) lr 2.0000e-03 eta 7:48:15
[调度器验证] batch 60: 学习率=0.000501
epoch [2/30] batch [60/200] time 14.279 (7.258) data 14.044 (7.021) loss 0.9649 (0.5440) acc 75.0000 (84.5833) lr 5.0075e-04 eta 11:34:23
[调度器验证] batch 80: 学习率=0.000501
epoch [2/30] batch [80/200] time 19.039 (9.638) data 18.804 (9.400) loss 1.1867 (0.4709) acc 75.0000 (87.1875) lr 5.0075e-04 eta 15:18:47
[调度器验证] batch 100: 学习率=0.002000
epoch [2/30] batch [100/200] time 23.796 (12.016) data 23.559 (11.779) loss 1.7876 (0.5829) acc 50.0000 (83.5000) lr 2.0000e-03 eta 19:01:33
[调度器验证] batch 120: 学习率=0.000501
epoch [2/30] batch [120/200] time 28.584 (14.399) data 28.350 (14.161) loss 0.8710 (0.5676) acc 75.0000 (83.9583) lr 5.0075e-04 eta 22:43:05
[调度器验证] batch 140: 学习率=0.000501
epoch [2/30] batch [140/200] time 33.361 (16.783) data 33.123 (16.545) loss 0.0640 (0.5306) acc 100.0000 (85.0000) lr 5.0075e-04 eta 1 day, 2:23:13
[调度器验证] batch 160: 学习率=0.002000
epoch [2/30] batch [160/200] time 38.138 (19.169) data 37.895 (18.931) loss 1.5034 (0.5376) acc 50.0000 (84.8438) lr 2.0000e-03 eta 1 day, 6:01:53
[调度器验证] batch 180: 学习率=0.000501
epoch [2/30] batch [180/200] time 42.883 (21.554) data 42.649 (21.316) loss 0.6761 (0.5253) acc 75.0000 (85.2778) lr 5.0075e-04 eta 1 day, 9:38:51
[调度器验证] batch 200: 学习率=0.000594
epoch [2/30] batch [200/200] time 47.638 (23.936) data 47.403 (23.699) loss 1.3818 (0.5429) acc 75.0000 (84.7500) lr 5.9397e-04 eta 1 day, 13:14:03
保存调度器 prompt_learner 的手动状态: {'last_epoch': 401}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-2
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001995
epoch [3/30] batch [20/200] time 4.792 (2.503) data 4.555 (2.264) loss 0.0641 (0.2821) acc 100.0000 (93.7500) lr 1.9945e-03 eta 3:52:48
[调度器验证] batch 40: 学习率=0.000413
epoch [3/30] batch [40/200] time 9.578 (4.903) data 9.338 (4.664) loss 0.1113 (0.4254) acc 100.0000 (89.3750) lr 4.1301e-04 eta 7:34:20
[调度器验证] batch 60: 学习率=0.000594
epoch [3/30] batch [60/200] time 14.342 (7.294) data 14.107 (7.055) loss 0.1012 (0.4422) acc 100.0000 (88.3333) lr 5.9397e-04 eta 11:13:28
[调度器验证] batch 80: 学习率=0.001995
epoch [3/30] batch [80/200] time 19.130 (9.683) data 18.889 (9.445) loss 0.3802 (0.3988) acc 100.0000 (89.3750) lr 1.9945e-03 eta 14:50:52
[调度器验证] batch 100: 学习率=0.000413
epoch [3/30] batch [100/200] time 23.914 (12.074) data 23.676 (11.835) loss 0.5830 (0.3846) acc 75.0000 (89.2500) lr 4.1301e-04 eta 18:26:47
[调度器验证] batch 120: 学习率=0.000594
epoch [3/30] batch [120/200] time 28.712 (14.468) data 28.474 (14.229) loss 0.2329 (0.3858) acc 100.0000 (88.5417) lr 5.9397e-04 eta 22:01:25
[调度器验证] batch 140: 学习率=0.001995
epoch [3/30] batch [140/200] time 33.501 (16.861) data 33.256 (16.623) loss 1.6261 (0.4228) acc 50.0000 (87.6786) lr 1.9945e-03 eta 1 day, 1:34:23
[调度器验证] batch 160: 学习率=0.000413
epoch [3/30] batch [160/200] time 38.263 (19.254) data 38.025 (19.015) loss 0.2212 (0.4335) acc 75.0000 (87.0312) lr 4.1301e-04 eta 1 day, 5:05:42
[调度器验证] batch 180: 学习率=0.000594
epoch [3/30] batch [180/200] time 43.035 (21.644) data 42.799 (21.406) loss 0.4426 (0.4302) acc 75.0000 (86.9444) lr 5.9397e-04 eta 1 day, 8:35:11
[调度器验证] batch 200: 学习率=0.001978
epoch [3/30] batch [200/200] time 47.812 (24.034) data 47.575 (23.795) loss 0.0272 (0.4209) acc 100.0000 (87.1250) lr 1.9782e-03 eta 1 day, 12:03:02
保存调度器 prompt_learner 的手动状态: {'last_epoch': 602}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-3
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000332
epoch [4/30] batch [20/200] time 4.790 (2.517) data 4.552 (2.278) loss 0.1752 (0.2110) acc 100.0000 (95.0000) lr 3.3170e-04 eta 3:45:40
[调度器验证] batch 40: 学习率=0.000692
epoch [4/30] batch [40/200] time 9.585 (4.911) data 9.341 (4.672) loss 0.0017 (0.2689) acc 100.0000 (93.7500) lr 6.9164e-04 eta 7:18:42
[调度器验证] batch 60: 学习率=0.001978
epoch [4/30] batch [60/200] time 14.378 (7.308) data 14.139 (7.068) loss 1.1819 (0.3022) acc 75.0000 (92.5000) lr 1.9782e-03 eta 10:50:22
[调度器验证] batch 80: 学习率=0.000332
epoch [4/30] batch [80/200] time 19.172 (9.704) data 18.936 (9.464) loss 0.0100 (0.3915) acc 100.0000 (90.0000) lr 3.3170e-04 eta 14:20:23
[调度器验证] batch 100: 学习率=0.000692
epoch [4/30] batch [100/200] time 23.943 (12.098) data 23.703 (11.860) loss 1.7959 (0.4200) acc 50.0000 (89.2500) lr 6.9164e-04 eta 17:48:41
[调度器验证] batch 120: 学习率=0.001978
epoch [4/30] batch [120/200] time 28.724 (14.491) data 28.485 (14.252) loss 0.8760 (0.3982) acc 75.0000 (89.5833) lr 1.9782e-03 eta 21:15:14
[调度器验证] batch 140: 学习率=0.000332
epoch [4/30] batch [140/200] time 33.497 (16.885) data 33.264 (16.646) loss 0.1807 (0.4154) acc 100.0000 (89.1071) lr 3.3170e-04 eta 1 day, 0:40:13
[调度器验证] batch 160: 学习率=0.000692
epoch [4/30] batch [160/200] time 38.199 (19.269) data 37.959 (19.030) loss 0.3667 (0.4467) acc 75.0000 (87.9688) lr 6.9164e-04 eta 1 day, 4:02:48
[调度器验证] batch 180: 学习率=0.001978
epoch [4/30] batch [180/200] time 42.915 (21.647) data 42.680 (21.409) loss 0.0537 (0.4350) acc 100.0000 (88.3333) lr 1.9782e-03 eta 1 day, 7:23:16
[调度器验证] batch 200: 学习率=0.000258
epoch [4/30] batch [200/200] time 47.652 (24.022) data 47.413 (23.785) loss 0.0079 (0.4287) acc 100.0000 (88.3750) lr 2.5773e-04 eta 1 day, 10:41:56
保存调度器 prompt_learner 的手动状态: {'last_epoch': 803}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-4
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000793
epoch [5/30] batch [20/200] time 4.728 (2.483) data 4.490 (2.247) loss 0.0083 (0.3134) acc 100.0000 (87.5000) lr 7.9269e-04 eta 3:34:23
[调度器验证] batch 40: 学习率=0.001951
epoch [5/30] batch [40/200] time 9.493 (4.853) data 9.258 (4.616) loss 0.0121 (0.2848) acc 100.0000 (89.3750) lr 1.9511e-03 eta 6:57:20
[调度器验证] batch 60: 学习率=0.000258
epoch [5/30] batch [60/200] time 14.250 (7.234) data 14.014 (6.997) loss 1.1248 (0.3307) acc 75.0000 (89.1667) lr 2.5773e-04 eta 10:19:40
[调度器验证] batch 80: 学习率=0.000793
epoch [5/30] batch [80/200] time 19.012 (9.611) data 18.770 (9.374) loss 0.0998 (0.3652) acc 100.0000 (88.7500) lr 7.9269e-04 eta 13:40:09
[调度器验证] batch 100: 学习率=0.001951
epoch [5/30] batch [100/200] time 23.821 (11.998) data 23.581 (11.760) loss 0.4472 (0.3652) acc 75.0000 (88.5000) lr 1.9511e-03 eta 16:59:47
[调度器验证] batch 120: 学习率=0.000258
epoch [5/30] batch [120/200] time 28.632 (14.389) data 28.393 (14.151) loss 0.0085 (0.3539) acc 100.0000 (89.1667) lr 2.5773e-04 eta 20:18:17
[调度器验证] batch 140: 学习率=0.000793
epoch [5/30] batch [140/200] time 33.422 (16.783) data 33.183 (16.545) loss 0.0080 (0.3632) acc 100.0000 (89.2857) lr 7.9269e-04 eta 23:35:21
[调度器验证] batch 160: 学习率=0.001951
epoch [5/30] batch [160/200] time 38.218 (19.178) data 37.976 (18.939) loss 0.0736 (0.3672) acc 100.0000 (89.3750) lr 1.9511e-03 eta 1 day, 2:50:56
[调度器验证] batch 180: 学习率=0.000258
epoch [5/30] batch [180/200] time 42.984 (21.571) data 42.748 (21.333) loss 0.0173 (0.3925) acc 100.0000 (88.4722) lr 2.5773e-04 eta 1 day, 6:04:48
[调度器验证] batch 200: 学习率=0.000896
epoch [5/30] batch [200/200] time 47.729 (23.962) data 47.494 (23.724) loss 0.6402 (0.3911) acc 50.0000 (88.0000) lr 8.9602e-04 eta 1 day, 9:16:51
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1004}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-5
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001914
epoch [6/30] batch [20/200] time 4.782 (2.528) data 4.546 (2.289) loss 0.0018 (0.2639) acc 100.0000 (91.2500) lr 1.9136e-03 eta 3:29:48
[调度器验证] batch 40: 学习率=0.000192
epoch [6/30] batch [40/200] time 9.512 (4.895) data 9.277 (4.658) loss 0.0122 (0.2682) acc 100.0000 (91.2500) lr 1.9189e-04 eta 6:44:40
[调度器验证] batch 60: 学习率=0.000896
epoch [6/30] batch [60/200] time 14.278 (7.267) data 14.039 (7.029) loss 0.0362 (0.3054) acc 100.0000 (89.5833) lr 8.9602e-04 eta 9:58:16
[调度器验证] batch 80: 学习率=0.001914
epoch [6/30] batch [80/200] time 19.052 (9.646) data 18.816 (9.408) loss 0.0072 (0.3074) acc 100.0000 (90.6250) lr 1.9136e-03 eta 13:10:58
[调度器验证] batch 100: 学习率=0.000192
epoch [6/30] batch [100/200] time 23.844 (12.030) data 23.603 (11.792) loss 0.0375 (0.2957) acc 100.0000 (91.2500) lr 1.9189e-04 eta 16:22:27
[调度器验证] batch 120: 学习率=0.000896
epoch [6/30] batch [120/200] time 28.618 (14.416) data 28.369 (14.178) loss 0.1048 (0.2978) acc 100.0000 (91.6667) lr 8.9602e-04 eta 19:32:30
[调度器验证] batch 140: 学习率=0.001914
epoch [6/30] batch [140/200] time 33.397 (16.805) data 33.162 (16.567) loss 0.0011 (0.3156) acc 100.0000 (90.7143) lr 1.9136e-03 eta 22:41:10
[调度器验证] batch 160: 学习率=0.000192
epoch [6/30] batch [160/200] time 38.194 (19.191) data 37.953 (18.953) loss 0.7060 (0.3233) acc 75.0000 (90.4688) lr 1.9189e-04 eta 1 day, 1:48:06
[调度器验证] batch 180: 学习率=0.000896
epoch [6/30] batch [180/200] time 43.134 (21.593) data 42.894 (21.354) loss 0.1172 (0.3213) acc 100.0000 (90.4167) lr 8.9602e-04 eta 1 day, 4:54:39
[调度器验证] batch 200: 学习率=0.001866
epoch [6/30] batch [200/200] time 47.920 (23.999) data 47.685 (23.760) loss 0.1048 (0.3187) acc 100.0000 (90.5000) lr 1.8661e-03 eta 1 day, 7:59:56
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1205}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-6
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000135
epoch [7/30] batch [20/200] time 4.770 (2.508) data 4.533 (2.270) loss 0.0021 (0.1647) acc 100.0000 (96.2500) lr 1.3491e-04 eta 3:19:47
[调度器验证] batch 40: 学习率=0.001000
epoch [7/30] batch [40/200] time 9.542 (4.893) data 9.305 (4.655) loss 0.3536 (0.2224) acc 100.0000 (93.7500) lr 1.0005e-03 eta 6:28:11
[调度器验证] batch 60: 学习率=0.001866
epoch [7/30] batch [60/200] time 14.299 (7.275) data 14.065 (7.037) loss 0.0011 (0.2613) acc 100.0000 (92.9167) lr 1.8661e-03 eta 9:34:41
[调度器验证] batch 80: 学习率=0.000135
epoch [7/30] batch [80/200] time 19.080 (9.658) data 18.841 (9.420) loss 0.0019 (0.2613) acc 100.0000 (92.5000) lr 1.3491e-04 eta 12:39:44
[调度器验证] batch 100: 学习率=0.001000
epoch [7/30] batch [100/200] time 23.793 (12.038) data 23.559 (11.800) loss 0.0073 (0.3233) acc 100.0000 (91.7500) lr 1.0005e-03 eta 15:42:57
[调度器验证] batch 120: 学习率=0.001866
epoch [7/30] batch [120/200] time 28.527 (14.410) data 28.293 (14.173) loss 0.1835 (0.3398) acc 100.0000 (90.8333) lr 1.8661e-03 eta 18:44:00
[调度器验证] batch 140: 学习率=0.000135
epoch [7/30] batch [140/200] time 33.265 (16.783) data 33.030 (16.546) loss 0.2998 (0.3445) acc 75.0000 (90.1786) lr 1.3491e-04 eta 21:43:27
[调度器验证] batch 160: 学习率=0.001001
epoch [7/30] batch [160/200] time 37.995 (19.153) data 37.758 (18.916) loss 0.0302 (0.3495) acc 100.0000 (89.8438) lr 1.0005e-03 eta 1 day, 0:41:09
[调度器验证] batch 180: 学习率=0.001866
epoch [7/30] batch [180/200] time 42.732 (21.523) data 42.493 (21.286) loss 0.0368 (0.3351) acc 100.0000 (90.4167) lr 1.8661e-03 eta 1 day, 3:37:14
[调度器验证] batch 200: 学习率=0.000087
epoch [7/30] batch [200/200] time 47.475 (23.892) data 47.239 (23.656) loss 0.1921 (0.3184) acc 100.0000 (91.0000) lr 8.7411e-05 eta 1 day, 6:31:45
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1406}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-7
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001105
epoch [8/30] batch [20/200] time 4.759 (2.501) data 4.523 (2.264) loss 0.0657 (0.3495) acc 100.0000 (91.2500) lr 1.1050e-03 eta 3:10:54
[调度器验证] batch 40: 学习率=0.001809
epoch [8/30] batch [40/200] time 9.431 (4.861) data 9.200 (4.626) loss 0.8720 (0.3003) acc 75.0000 (91.2500) lr 1.8091e-03 eta 6:09:28
[调度器验证] batch 60: 学习率=0.000087
epoch [8/30] batch [60/200] time 14.134 (7.206) data 13.896 (6.971) loss 0.0053 (0.3188) acc 100.0000 (90.0000) lr 8.7411e-05 eta 9:05:16
[调度器验证] batch 80: 学习率=0.001105
epoch [8/30] batch [80/200] time 18.834 (9.555) data 18.600 (9.320) loss 0.0166 (0.2949) acc 100.0000 (91.2500) lr 1.1050e-03 eta 11:59:47
[调度器验证] batch 100: 学习率=0.001809
epoch [8/30] batch [100/200] time 23.555 (11.906) data 23.323 (11.671) loss 0.2502 (0.3051) acc 100.0000 (91.5000) lr 1.8091e-03 eta 14:52:58
[调度器验证] batch 120: 学习率=0.000087
epoch [8/30] batch [120/200] time 28.293 (14.263) data 28.058 (14.027) loss 0.4448 (0.3171) acc 100.0000 (91.0417) lr 8.7411e-05 eta 17:44:57
[调度器验证] batch 140: 学习率=0.001105
epoch [8/30] batch [140/200] time 33.055 (16.622) data 32.805 (16.387) loss 0.0034 (0.3130) acc 100.0000 (91.0714) lr 1.1050e-03 eta 20:35:34
[调度器验证] batch 160: 学习率=0.001809
epoch [8/30] batch [160/200] time 37.817 (18.989) data 37.577 (18.753) loss 1.2102 (0.3101) acc 50.0000 (91.0938) lr 1.8091e-03 eta 23:25:12
[调度器验证] batch 180: 学习率=0.000087
epoch [8/30] batch [180/200] time 42.657 (21.363) data 42.417 (21.127) loss 0.0065 (0.3150) acc 100.0000 (90.6944) lr 8.7411e-05 eta 1 day, 2:13:44
[调度器验证] batch 200: 学习率=0.001208
epoch [8/30] batch [200/200] time 47.476 (23.746) data 47.237 (23.509) loss 0.0239 (0.3341) acc 100.0000 (89.8750) lr 1.2083e-03 eta 1 day, 5:01:21
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1607}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-8
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001743
epoch [9/30] batch [20/200] time 4.817 (2.528) data 4.577 (2.288) loss 1.0193 (0.2118) acc 50.0000 (92.5000) lr 1.7433e-03 eta 3:04:33
[调度器验证] batch 40: 学习率=0.000050
epoch [9/30] batch [40/200] time 9.615 (4.936) data 9.379 (4.696) loss 0.3237 (0.2995) acc 100.0000 (92.5000) lr 4.9919e-05 eta 5:58:40
[调度器验证] batch 60: 学习率=0.001208
epoch [9/30] batch [60/200] time 14.389 (7.331) data 14.152 (7.092) loss 0.1409 (0.2606) acc 100.0000 (93.3333) lr 1.2083e-03 eta 8:50:17
[调度器验证] batch 80: 学习率=0.001743
epoch [9/30] batch [80/200] time 19.137 (9.719) data 18.897 (9.480) loss 0.0296 (0.2314) acc 100.0000 (93.7500) lr 1.7433e-03 eta 11:39:44
[调度器验证] batch 100: 学习率=0.000050
epoch [9/30] batch [100/200] time 23.933 (12.105) data 23.692 (11.866) loss 0.1518 (0.2869) acc 100.0000 (91.2500) lr 4.9919e-05 eta 14:27:31
[调度器验证] batch 120: 学习率=0.001208
epoch [9/30] batch [120/200] time 28.705 (14.494) data 28.465 (14.256) loss 0.0025 (0.3031) acc 100.0000 (90.2083) lr 1.2083e-03 eta 17:13:55
[调度器验证] batch 140: 学习率=0.001743
epoch [9/30] batch [140/200] time 33.451 (16.880) data 33.214 (16.642) loss 0.0211 (0.2971) acc 100.0000 (90.7143) lr 1.7433e-03 eta 19:58:30
[调度器验证] batch 160: 学习率=0.000050
epoch [9/30] batch [160/200] time 38.230 (19.265) data 37.992 (19.026) loss 0.0146 (0.3033) acc 100.0000 (90.4688) lr 4.9919e-05 eta 22:41:21
[调度器验证] batch 180: 学习率=0.001208
epoch [9/30] batch [180/200] time 42.990 (21.649) data 42.754 (21.411) loss 0.0046 (0.2943) acc 100.0000 (90.6944) lr 1.2083e-03 eta 1 day, 1:22:39
[调度器验证] batch 200: 学习率=0.001669
epoch [9/30] batch [200/200] time 47.787 (24.036) data 47.550 (23.797) loss 0.0023 (0.2878) acc 100.0000 (90.8750) lr 1.6693e-03 eta 1 day, 4:02:29
保存调度器 prompt_learner 的手动状态: {'last_epoch': 1808}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-9
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000023
epoch [10/30] batch [20/200] time 4.776 (2.511) data 4.540 (2.272) loss 0.2026 (0.1803) acc 100.0000 (96.2500) lr 2.2841e-05 eta 2:54:54
[调度器验证] batch 40: 学习率=0.001309
epoch [10/30] batch [40/200] time 9.542 (4.895) data 9.303 (4.657) loss 0.2046 (0.2214) acc 100.0000 (94.3750) lr 1.3094e-03 eta 5:39:24
[调度器验证] batch 60: 学习率=0.001669
epoch [10/30] batch [60/200] time 14.316 (7.279) data 14.078 (7.041) loss 0.0387 (0.2347) acc 100.0000 (92.9167) lr 1.6693e-03 eta 8:22:16
[调度器验证] batch 80: 学习率=0.000023
epoch [10/30] batch [80/200] time 19.116 (9.668) data 18.877 (9.429) loss 0.4751 (0.2483) acc 75.0000 (91.5625) lr 2.2841e-05 eta 11:03:51
[调度器验证] batch 100: 学习率=0.001309
epoch [10/30] batch [100/200] time 23.885 (12.059) data 23.647 (11.820) loss 0.5885 (0.2433) acc 75.0000 (92.5000) lr 1.3094e-03 eta 13:44:01
[调度器验证] batch 120: 学习率=0.001669
epoch [10/30] batch [120/200] time 28.667 (14.449) data 28.431 (14.210) loss 0.0527 (0.2629) acc 100.0000 (91.8750) lr 1.6693e-03 eta 16:22:29
[调度器验证] batch 140: 学习率=0.000023
epoch [10/30] batch [140/200] time 33.449 (16.838) data 33.211 (16.600) loss 0.0010 (0.2342) acc 100.0000 (92.8571) lr 2.2841e-05 eta 18:59:24
[调度器验证] batch 160: 学习率=0.001309
epoch [10/30] batch [160/200] time 38.211 (19.227) data 37.975 (18.989) loss 0.6789 (0.2472) acc 75.0000 (92.1875) lr 1.3094e-03 eta 21:34:37
[调度器验证] batch 180: 学习率=0.001669
epoch [10/30] batch [180/200] time 42.952 (21.614) data 42.717 (21.376) loss 0.0344 (0.2611) acc 100.0000 (91.9444) lr 1.6693e-03 eta 1 day, 0:08:08
[调度器验证] batch 200: 学习率=0.000006
epoch [10/30] batch [200/200] time 47.655 (23.994) data 47.420 (23.756) loss 2.1946 (0.2862) acc 75.0000 (91.3750) lr 6.4754e-06 eta 1 day, 2:39:35
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2009}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-10
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001407
epoch [11/30] batch [20/200] time 4.734 (2.487) data 4.495 (2.251) loss 0.0126 (0.2623) acc 100.0000 (93.7500) lr 1.4070e-03 eta 2:44:59
[调度器验证] batch 40: 学习率=0.001588
epoch [11/30] batch [40/200] time 9.530 (4.866) data 9.285 (4.628) loss 0.0008 (0.2207) acc 100.0000 (95.0000) lr 1.5880e-03 eta 5:21:08
[调度器验证] batch 60: 学习率=0.000006
epoch [11/30] batch [60/200] time 14.325 (7.260) data 14.087 (7.022) loss 0.1325 (0.2391) acc 100.0000 (93.7500) lr 6.4754e-06 eta 7:56:44
[调度器验证] batch 80: 学习率=0.001407
epoch [11/30] batch [80/200] time 19.097 (9.653) data 18.857 (9.415) loss 0.7837 (0.2263) acc 75.0000 (94.0625) lr 1.4070e-03 eta 10:30:40
[调度器验证] batch 100: 学习率=0.001588
epoch [11/30] batch [100/200] time 23.867 (12.043) data 23.631 (11.805) loss 0.0075 (0.2385) acc 100.0000 (94.0000) lr 1.5880e-03 eta 13:02:47
[调度器验证] batch 120: 学习率=0.000006
epoch [11/30] batch [120/200] time 28.686 (14.434) data 28.445 (14.195) loss 0.0060 (0.2260) acc 100.0000 (94.5833) lr 6.4754e-06 eta 15:33:24
[调度器验证] batch 140: 学习率=0.001407
epoch [11/30] batch [140/200] time 33.503 (16.832) data 33.265 (16.593) loss 0.0391 (0.2270) acc 100.0000 (94.6429) lr 1.4070e-03 eta 18:02:51
[调度器验证] batch 160: 学习率=0.001588
epoch [11/30] batch [160/200] time 38.309 (19.231) data 38.071 (18.992) loss 1.7450 (0.2361) acc 75.0000 (94.3750) lr 1.5880e-03 eta 20:30:48
[调度器验证] batch 180: 学习率=0.000006
epoch [11/30] batch [180/200] time 43.091 (21.630) data 42.847 (21.391) loss 0.0020 (0.2438) acc 100.0000 (94.0278) lr 6.4754e-06 eta 22:57:05
[调度器验证] batch 200: 学习率=0.001500
epoch [11/30] batch [200/200] time 47.877 (24.027) data 47.638 (23.788) loss 0.0016 (0.2512) acc 100.0000 (93.5000) lr 1.5003e-03 eta 1 day, 1:21:43
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2210}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-11
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001500
epoch [12/30] batch [20/200] time 4.792 (2.521) data 4.553 (2.282) loss 0.0160 (0.2496) acc 100.0000 (93.7500) lr 1.5003e-03 eta 2:38:50
[调度器验证] batch 40: 学习率=0.000001
epoch [12/30] batch [40/200] time 9.577 (4.914) data 9.338 (4.675) loss 0.0595 (0.2572) acc 100.0000 (93.1250) lr 1.0000e-06 eta 5:07:55
[调度器验证] batch 60: 学习率=0.001500
epoch [12/30] batch [60/200] time 14.334 (7.302) data 14.097 (7.063) loss 0.0021 (0.2856) acc 100.0000 (92.5000) lr 1.5003e-03 eta 7:35:08
[调度器验证] batch 80: 学习率=0.001500
epoch [12/30] batch [80/200] time 19.098 (9.685) data 18.860 (9.447) loss 0.0230 (0.2544) acc 100.0000 (93.1250) lr 1.5003e-03 eta 10:00:28
[调度器验证] batch 100: 学习率=0.000001
epoch [12/30] batch [100/200] time 23.900 (12.072) data 23.662 (11.833) loss 0.2988 (0.2526) acc 75.0000 (92.7500) lr 1.0000e-06 eta 12:24:25
[调度器验证] batch 120: 学习率=0.001500
epoch [12/30] batch [120/200] time 28.679 (14.462) data 28.443 (14.224) loss 0.0004 (0.2623) acc 100.0000 (92.2917) lr 1.5003e-03 eta 14:47:00
[调度器验证] batch 140: 学习率=0.001500
epoch [12/30] batch [140/200] time 33.458 (16.852) data 33.218 (16.613) loss 0.5024 (0.2644) acc 75.0000 (91.9643) lr 1.5003e-03 eta 17:07:56
[调度器验证] batch 160: 学习率=0.000001
epoch [12/30] batch [160/200] time 38.271 (19.243) data 38.032 (19.004) loss 0.0158 (0.2614) acc 100.0000 (92.0312) lr 1.0000e-06 eta 19:27:23
[调度器验证] batch 180: 学习率=0.001500
epoch [12/30] batch [180/200] time 43.260 (21.649) data 43.023 (21.409) loss 0.0541 (0.2791) acc 100.0000 (92.0833) lr 1.5003e-03 eta 21:46:09
[调度器验证] batch 200: 学习率=0.001407
epoch [12/30] batch [200/200] time 48.039 (24.061) data 47.800 (23.821) loss 0.4176 (0.2838) acc 75.0000 (91.8750) lr 1.4070e-03 eta 1 day, 0:03:39
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2411}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-12
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000006
epoch [13/30] batch [20/200] time 4.778 (2.513) data 4.537 (2.274) loss 0.0032 (0.3933) acc 100.0000 (87.5000) lr 6.4754e-06 eta 2:29:55
[调度器验证] batch 40: 学习率=0.001588
epoch [13/30] batch [40/200] time 9.555 (4.898) data 9.316 (4.660) loss 1.2930 (0.4323) acc 75.0000 (88.7500) lr 1.5880e-03 eta 4:50:38
[调度器验证] batch 60: 学习率=0.001407
epoch [13/30] batch [60/200] time 14.331 (7.287) data 14.090 (7.048) loss 0.0180 (0.3511) acc 100.0000 (90.8333) lr 1.4070e-03 eta 7:09:54
[调度器验证] batch 80: 学习率=0.000006
epoch [13/30] batch [80/200] time 19.089 (9.673) data 18.855 (9.434) loss 0.0482 (0.2949) acc 100.0000 (92.1875) lr 6.4754e-06 eta 9:27:27
[调度器验证] batch 100: 学习率=0.001588
epoch [13/30] batch [100/200] time 23.825 (12.053) data 23.591 (11.815) loss 1.0797 (0.3423) acc 75.0000 (90.5000) lr 1.5880e-03 eta 11:43:06
[调度器验证] batch 120: 学习率=0.001407
epoch [13/30] batch [120/200] time 28.578 (14.431) data 28.341 (14.193) loss 0.0189 (0.3325) acc 100.0000 (90.4167) lr 1.4070e-03 eta 13:57:00
[调度器验证] batch 140: 学习率=0.000006
epoch [13/30] batch [140/200] time 33.314 (16.807) data 33.078 (16.570) loss 0.7321 (0.3369) acc 75.0000 (89.8214) lr 6.4754e-06 eta 16:09:12
[调度器验证] batch 160: 学习率=0.001588
epoch [13/30] batch [160/200] time 38.100 (19.184) data 37.862 (18.946) loss 0.2125 (0.3326) acc 75.0000 (90.0000) lr 1.5880e-03 eta 18:19:52
[调度器验证] batch 180: 学习率=0.001407
epoch [13/30] batch [180/200] time 42.852 (21.563) data 42.611 (21.325) loss 0.9042 (0.3249) acc 75.0000 (90.1389) lr 1.4070e-03 eta 20:29:04
[调度器验证] batch 200: 学习率=0.000023
epoch [13/30] batch [200/200] time 47.608 (23.941) data 47.370 (23.704) loss 0.0098 (0.3117) acc 100.0000 (90.7500) lr 2.2841e-05 eta 22:36:40
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2612}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-13
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001669
epoch [14/30] batch [20/200] time 4.766 (2.503) data 4.528 (2.265) loss 0.3811 (0.2087) acc 100.0000 (95.0000) lr 1.6693e-03 eta 2:21:00
[调度器验证] batch 40: 学习率=0.001309
epoch [14/30] batch [40/200] time 9.532 (4.886) data 9.294 (4.648) loss 0.0012 (0.2583) acc 100.0000 (93.1250) lr 1.3094e-03 eta 4:33:36
[调度器验证] batch 60: 学习率=0.000023
epoch [14/30] batch [60/200] time 14.295 (7.268) data 14.058 (7.031) loss 0.7714 (0.2457) acc 75.0000 (93.3333) lr 2.2841e-05 eta 6:44:36
[调度器验证] batch 80: 学习率=0.001669
epoch [14/30] batch [80/200] time 19.063 (9.650) data 18.826 (9.412) loss 0.4440 (0.2827) acc 75.0000 (91.5625) lr 1.6693e-03 eta 8:53:58
[调度器验证] batch 100: 学习率=0.001309
epoch [14/30] batch [100/200] time 23.837 (12.035) data 23.599 (11.797) loss 0.0053 (0.3044) acc 100.0000 (91.2500) lr 1.3094e-03 eta 11:01:55
[调度器验证] batch 120: 学习率=0.000023
epoch [14/30] batch [120/200] time 28.626 (14.421) data 28.383 (14.182) loss 0.0497 (0.3038) acc 100.0000 (91.0417) lr 2.2841e-05 eta 13:08:19
[调度器验证] batch 140: 学习率=0.001669
epoch [14/30] batch [140/200] time 33.401 (16.809) data 33.163 (16.571) loss 0.0116 (0.3172) acc 100.0000 (90.1786) lr 1.6693e-03 eta 15:13:16
[调度器验证] batch 160: 学习率=0.001309
epoch [14/30] batch [160/200] time 38.153 (19.194) data 37.913 (18.956) loss 0.0206 (0.3317) acc 100.0000 (89.8438) lr 1.3094e-03 eta 17:16:29
[调度器验证] batch 180: 学习率=0.000023
epoch [14/30] batch [180/200] time 42.928 (21.579) data 42.693 (21.341) loss 0.2731 (0.3236) acc 75.0000 (89.8611) lr 2.2841e-05 eta 19:18:04
[调度器验证] batch 200: 学习率=0.001743
epoch [14/30] batch [200/200] time 47.706 (23.964) data 47.467 (23.726) loss 0.0011 (0.3306) acc 100.0000 (89.7500) lr 1.7433e-03 eta 21:18:05
保存调度器 prompt_learner 的手动状态: {'last_epoch': 2813}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-14
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001208
epoch [15/30] batch [20/200] time 4.795 (2.522) data 4.561 (2.283) loss 0.2461 (0.2045) acc 100.0000 (95.0000) lr 1.2083e-03 eta 2:13:40
[调度器验证] batch 40: 学习率=0.000050
epoch [15/30] batch [40/200] time 9.651 (4.932) data 9.411 (4.691) loss 0.9059 (0.2437) acc 75.0000 (94.3750) lr 4.9919e-05 eta 4:19:43
[调度器验证] batch 60: 学习率=0.001743
epoch [15/30] batch [60/200] time 14.473 (7.351) data 14.230 (7.110) loss 0.0123 (0.2463) acc 100.0000 (93.7500) lr 1.7433e-03 eta 6:24:41
[调度器验证] batch 80: 学习率=0.001208
epoch [15/30] batch [80/200] time 19.275 (9.762) data 19.036 (9.522) loss 0.0059 (0.2503) acc 100.0000 (93.4375) lr 1.2083e-03 eta 8:27:37
[调度器验证] batch 100: 学习率=0.000050
epoch [15/30] batch [100/200] time 24.100 (12.171) data 23.856 (11.931) loss 0.0029 (0.2437) acc 100.0000 (93.7500) lr 4.9919e-05 eta 10:28:50
[调度器验证] batch 120: 学习率=0.001743
epoch [15/30] batch [120/200] time 28.903 (14.580) data 28.661 (14.340) loss 0.0018 (0.2474) acc 100.0000 (93.5417) lr 1.7433e-03 eta 12:28:27
[调度器验证] batch 140: 学习率=0.001208
epoch [15/30] batch [140/200] time 33.697 (16.986) data 33.460 (16.746) loss 0.0461 (0.2498) acc 100.0000 (93.3929) lr 1.2083e-03 eta 14:26:17
[调度器验证] batch 160: 学习率=0.000050
epoch [15/30] batch [160/200] time 38.496 (19.389) data 38.255 (19.149) loss 0.4385 (0.2524) acc 75.0000 (93.1250) lr 4.9919e-05 eta 16:22:23
[调度器验证] batch 180: 学习率=0.001743
epoch [15/30] batch [180/200] time 43.294 (21.792) data 43.057 (21.552) loss 0.0011 (0.2568) acc 100.0000 (92.9167) lr 1.7433e-03 eta 18:16:52
[调度器验证] batch 200: 学习率=0.001105
epoch [15/30] batch [200/200] time 48.104 (24.195) data 47.865 (23.955) loss 0.0031 (0.2469) acc 100.0000 (93.1250) lr 1.1050e-03 eta 20:09:46
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3014}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-15
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000087
epoch [16/30] batch [20/200] time 4.780 (2.513) data 4.543 (2.274) loss 0.0130 (0.1267) acc 100.0000 (95.0000) lr 8.7411e-05 eta 2:04:48
[调度器验证] batch 40: 学习率=0.001809
epoch [16/30] batch [40/200] time 9.534 (4.896) data 9.298 (4.658) loss 0.0042 (0.0968) acc 100.0000 (96.2500) lr 1.8091e-03 eta 4:01:30
[调度器验证] batch 60: 学习率=0.001105
epoch [16/30] batch [60/200] time 14.265 (7.273) data 14.030 (7.035) loss 0.0071 (0.1394) acc 100.0000 (95.4167) lr 1.1050e-03 eta 5:56:21
[调度器验证] batch 80: 学习率=0.000087
epoch [16/30] batch [80/200] time 19.003 (9.643) data 18.769 (9.406) loss 1.4572 (0.1561) acc 75.0000 (95.3125) lr 8.7411e-05 eta 7:49:16
[调度器验证] batch 100: 学习率=0.001809
epoch [16/30] batch [100/200] time 23.736 (12.011) data 23.502 (11.775) loss 0.0354 (0.1705) acc 100.0000 (95.2500) lr 1.8091e-03 eta 9:40:33
[调度器验证] batch 120: 学习率=0.001105
epoch [16/30] batch [120/200] time 28.492 (14.381) data 28.257 (14.145) loss 0.0517 (0.1873) acc 100.0000 (94.5833) lr 1.1050e-03 eta 11:30:18
[调度器验证] batch 140: 学习率=0.000087
epoch [16/30] batch [140/200] time 33.271 (16.756) data 33.032 (16.519) loss 0.1713 (0.1925) acc 100.0000 (94.2857) lr 8.7411e-05 eta 13:18:43
[调度器验证] batch 160: 学习率=0.001809
epoch [16/30] batch [160/200] time 38.029 (19.133) data 37.793 (18.896) loss 0.0012 (0.1951) acc 100.0000 (94.3750) lr 1.8091e-03 eta 15:05:37
[调度器验证] batch 180: 学习率=0.001105
epoch [16/30] batch [180/200] time 42.776 (21.509) data 42.535 (21.272) loss 0.0849 (0.2089) acc 100.0000 (93.8889) lr 1.1050e-03 eta 16:50:56
[调度器验证] batch 200: 学习率=0.000135
epoch [16/30] batch [200/200] time 47.564 (23.887) data 47.320 (23.649) loss 0.0093 (0.2194) acc 100.0000 (93.6250) lr 1.3491e-04 eta 18:34:42
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3215}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-16
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001866
epoch [17/30] batch [20/200] time 4.828 (2.539) data 4.589 (2.298) loss 0.0197 (0.2320) acc 100.0000 (93.7500) lr 1.8661e-03 eta 1:57:37
[调度器验证] batch 40: 学习率=0.001001
epoch [17/30] batch [40/200] time 9.615 (4.939) data 9.376 (4.699) loss 0.0242 (0.2834) acc 100.0000 (94.3750) lr 1.0005e-03 eta 3:47:10
[调度器验证] batch 60: 学习率=0.000135
epoch [17/30] batch [60/200] time 14.420 (7.338) data 14.176 (7.098) loss 0.0573 (0.2251) acc 100.0000 (95.8333) lr 1.3491e-04 eta 5:35:05
[调度器验证] batch 80: 学习率=0.001866
epoch [17/30] batch [80/200] time 19.183 (9.734) data 18.947 (9.495) loss 0.0012 (0.2057) acc 100.0000 (96.2500) lr 1.8661e-03 eta 7:21:16
[调度器验证] batch 100: 学习率=0.001001
epoch [17/30] batch [100/200] time 23.951 (12.123) data 23.709 (11.884) loss 0.0016 (0.2336) acc 100.0000 (95.0000) lr 1.0005e-03 eta 9:05:33
[调度器验证] batch 120: 学习率=0.000135
epoch [17/30] batch [120/200] time 28.734 (14.513) data 28.497 (14.274) loss 0.0421 (0.2350) acc 100.0000 (94.5833) lr 1.3491e-04 eta 10:48:15
[调度器验证] batch 140: 学习率=0.001866
epoch [17/30] batch [140/200] time 33.465 (16.900) data 33.232 (16.662) loss 0.0002 (0.2163) acc 100.0000 (95.1786) lr 1.8661e-03 eta 12:29:14
[调度器验证] batch 160: 学习率=0.001000
epoch [17/30] batch [160/200] time 38.205 (19.282) data 37.969 (19.044) loss 0.0825 (0.2413) acc 100.0000 (94.3750) lr 1.0005e-03 eta 14:08:24
[调度器验证] batch 180: 学习率=0.000135
epoch [17/30] batch [180/200] time 42.961 (21.662) data 42.724 (21.424) loss 0.0510 (0.2407) acc 100.0000 (94.1667) lr 1.3491e-04 eta 15:45:54
[调度器验证] batch 200: 学习率=0.001914
epoch [17/30] batch [200/200] time 47.722 (24.042) data 47.485 (23.804) loss 0.2291 (0.2404) acc 75.0000 (93.8750) lr 1.9136e-03 eta 17:21:48
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3416}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-17
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000896
epoch [18/30] batch [20/200] time 4.796 (2.518) data 4.554 (2.278) loss 0.3257 (0.2338) acc 75.0000 (92.5000) lr 8.9602e-04 eta 1:48:15
[调度器验证] batch 40: 学习率=0.000192
epoch [18/30] batch [40/200] time 9.594 (4.919) data 9.354 (4.679) loss 0.3100 (0.2422) acc 100.0000 (93.1250) lr 1.9189e-04 eta 3:29:52
[调度器验证] batch 60: 学习率=0.001914
epoch [18/30] batch [60/200] time 14.369 (7.312) data 14.132 (7.073) loss 0.0566 (0.2618) acc 100.0000 (93.3333) lr 1.9136e-03 eta 5:09:31
[调度器验证] batch 80: 学习率=0.000896
epoch [18/30] batch [80/200] time 19.186 (9.706) data 18.941 (9.467) loss 0.0145 (0.2553) acc 100.0000 (93.1250) lr 8.9602e-04 eta 6:47:39
[调度器验证] batch 100: 学习率=0.000192
epoch [18/30] batch [100/200] time 23.988 (12.106) data 23.750 (11.867) loss 0.0015 (0.2477) acc 100.0000 (93.2500) lr 1.9189e-04 eta 8:24:25
[调度器验证] batch 120: 学习率=0.001914
epoch [18/30] batch [120/200] time 28.823 (14.511) data 28.584 (14.271) loss 0.4487 (0.2299) acc 75.0000 (93.9583) lr 1.9136e-03 eta 9:59:47
[调度器验证] batch 140: 学习率=0.000896
epoch [18/30] batch [140/200] time 33.627 (16.916) data 33.386 (16.676) loss 0.0004 (0.2048) acc 100.0000 (94.6429) lr 8.9602e-04 eta 11:33:33
[调度器验证] batch 160: 学习率=0.000192
epoch [18/30] batch [160/200] time 38.430 (19.321) data 38.190 (19.081) loss 0.1404 (0.2210) acc 100.0000 (94.5312) lr 1.9189e-04 eta 13:05:42
[调度器验证] batch 180: 学习率=0.001914
epoch [18/30] batch [180/200] time 43.354 (21.730) data 43.115 (21.490) loss 0.6937 (0.2332) acc 75.0000 (94.0278) lr 1.9136e-03 eta 14:36:26
[调度器验证] batch 200: 学习率=0.000793
epoch [18/30] batch [200/200] time 48.137 (24.144) data 47.899 (23.904) loss 0.0004 (0.2225) acc 100.0000 (94.2500) lr 7.9269e-04 eta 16:05:45
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3617}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-18
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000258
epoch [19/30] batch [20/200] time 4.850 (2.552) data 4.611 (2.310) loss 0.4679 (0.4074) acc 75.0000 (88.7500) lr 2.5773e-04 eta 1:41:14
[调度器验证] batch 40: 学习率=0.001951
epoch [19/30] batch [40/200] time 9.669 (4.968) data 9.431 (4.726) loss 0.0245 (0.3242) acc 100.0000 (91.2500) lr 1.9511e-03 eta 3:15:23
[调度器验证] batch 60: 学习率=0.000793
epoch [19/30] batch [60/200] time 14.452 (7.374) data 14.215 (7.133) loss 0.0047 (0.2663) acc 100.0000 (92.9167) lr 7.9269e-04 eta 4:47:34
[调度器验证] batch 80: 学习率=0.000258
epoch [19/30] batch [80/200] time 19.255 (9.773) data 19.015 (9.532) loss 0.0690 (0.2709) acc 100.0000 (92.5000) lr 2.5773e-04 eta 6:17:52
[调度器验证] batch 100: 学习率=0.001951
epoch [19/30] batch [100/200] time 24.053 (12.172) data 23.812 (11.932) loss 0.0028 (0.2470) acc 100.0000 (93.2500) lr 1.9511e-03 eta 7:46:35
[调度器验证] batch 120: 学习率=0.000793
epoch [19/30] batch [120/200] time 28.833 (14.570) data 28.593 (14.330) loss 0.9487 (0.2350) acc 75.0000 (93.1250) lr 7.9269e-04 eta 9:13:38
[调度器验证] batch 140: 学习率=0.000258
epoch [19/30] batch [140/200] time 33.579 (16.963) data 33.342 (16.724) loss 0.0030 (0.2378) acc 100.0000 (93.0357) lr 2.5773e-04 eta 10:38:56
[调度器验证] batch 160: 学习率=0.001951
epoch [19/30] batch [160/200] time 38.339 (19.353) data 38.103 (19.114) loss 0.1366 (0.2392) acc 100.0000 (92.9688) lr 1.9511e-03 eta 12:02:30
[调度器验证] batch 180: 学习率=0.000793
epoch [19/30] batch [180/200] time 43.137 (21.742) data 42.899 (21.503) loss 0.0132 (0.2348) acc 100.0000 (93.0556) lr 7.9269e-04 eta 13:24:27
[调度器验证] batch 200: 学习率=0.000332
epoch [19/30] batch [200/200] time 47.903 (24.132) data 47.661 (23.893) loss 1.2500 (0.2339) acc 75.0000 (93.0000) lr 3.3170e-04 eta 14:44:49
保存调度器 prompt_learner 的手动状态: {'last_epoch': 3818}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-19
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.001978
epoch [20/30] batch [20/200] time 4.750 (2.494) data 4.508 (2.257) loss 0.5998 (0.1640) acc 75.0000 (95.0000) lr 1.9782e-03 eta 1:30:36
[调度器验证] batch 40: 学习率=0.000692
epoch [20/30] batch [40/200] time 9.503 (4.871) data 9.269 (4.634) loss 0.0071 (0.2453) acc 100.0000 (94.3750) lr 6.9164e-04 eta 2:55:22
[调度器验证] batch 60: 学习率=0.000332
epoch [20/30] batch [60/200] time 14.262 (7.249) data 14.024 (7.011) loss 0.0200 (0.2879) acc 100.0000 (92.0833) lr 3.3170e-04 eta 4:18:32
[调度器验证] batch 80: 学习率=0.001978
epoch [20/30] batch [80/200] time 19.082 (9.635) data 18.845 (9.397) loss 0.3068 (0.2824) acc 100.0000 (92.5000) lr 1.9782e-03 eta 5:40:25
[调度器验证] batch 100: 学习率=0.000692
epoch [20/30] batch [100/200] time 23.863 (12.026) data 23.626 (11.788) loss 1.1055 (0.2853) acc 50.0000 (92.0000) lr 6.9164e-04 eta 7:00:55
[调度器验证] batch 120: 学习率=0.000332
epoch [20/30] batch [120/200] time 28.630 (14.417) data 28.395 (14.179) loss 0.0157 (0.2949) acc 100.0000 (91.4583) lr 3.3170e-04 eta 8:19:46
[调度器验证] batch 140: 学习率=0.001978
epoch [20/30] batch [140/200] time 33.440 (16.807) data 33.195 (16.568) loss 1.2656 (0.3146) acc 75.0000 (91.2500) lr 1.9782e-03 eta 9:37:01
[调度器验证] batch 160: 学习率=0.000692
epoch [20/30] batch [160/200] time 38.205 (19.199) data 37.969 (18.960) loss 0.0098 (0.3031) acc 100.0000 (91.4062) lr 6.9164e-04 eta 10:52:44
[调度器验证] batch 180: 学习率=0.000332
epoch [20/30] batch [180/200] time 42.985 (21.589) data 42.746 (21.351) loss 0.1481 (0.2913) acc 100.0000 (91.8056) lr 3.3170e-04 eta 12:06:50
[调度器验证] batch 200: 学习率=0.001995
epoch [20/30] batch [200/200] time 47.745 (23.978) data 47.507 (23.740) loss 0.1738 (0.2909) acc 100.0000 (92.1250) lr 1.9945e-03 eta 13:19:16
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4019}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-20
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000594
epoch [21/30] batch [20/200] time 4.685 (2.481) data 4.455 (2.248) loss 0.4823 (0.3050) acc 75.0000 (92.5000) lr 5.9397e-04 eta 1:21:53
[调度器验证] batch 40: 学习率=0.000413
epoch [21/30] batch [40/200] time 9.337 (4.804) data 9.106 (4.571) loss 0.0173 (0.2132) acc 100.0000 (95.0000) lr 4.1301e-04 eta 2:36:56
[调度器验证] batch 60: 学习率=0.001995
epoch [21/30] batch [60/200] time 14.042 (7.137) data 13.804 (6.904) loss 0.6442 (0.2266) acc 75.0000 (94.1667) lr 1.9945e-03 eta 3:50:46
[调度器验证] batch 80: 学习率=0.000594
epoch [21/30] batch [80/200] time 18.785 (9.485) data 18.550 (9.251) loss 0.0015 (0.2041) acc 100.0000 (94.6875) lr 5.9397e-04 eta 5:03:32
[调度器验证] batch 100: 学习率=0.000413
epoch [21/30] batch [100/200] time 23.561 (11.846) data 23.324 (11.611) loss 0.2287 (0.2110) acc 100.0000 (94.2500) lr 4.1301e-04 eta 6:15:06
[调度器验证] batch 120: 学习率=0.001995
epoch [21/30] batch [120/200] time 28.381 (14.220) data 28.144 (13.984) loss 0.0035 (0.2205) acc 100.0000 (93.7500) lr 1.9945e-03 eta 7:25:33
[调度器验证] batch 140: 学习率=0.000594
epoch [21/30] batch [140/200] time 33.185 (16.604) data 32.945 (16.367) loss 0.0048 (0.2341) acc 100.0000 (93.3929) lr 5.9397e-04 eta 8:34:43
[调度器验证] batch 160: 学习率=0.000413
epoch [21/30] batch [160/200] time 37.963 (18.990) data 37.725 (18.753) loss 0.2237 (0.2267) acc 100.0000 (93.9062) lr 4.1301e-04 eta 9:42:21
[调度器验证] batch 180: 学习率=0.001995
epoch [21/30] batch [180/200] time 42.746 (21.378) data 42.509 (21.141) loss 0.0696 (0.2253) acc 100.0000 (94.0278) lr 1.9945e-03 eta 10:48:27
[调度器验证] batch 200: 学习率=0.000501
epoch [21/30] batch [200/200] time 47.552 (23.767) data 47.314 (23.530) loss 0.0154 (0.2120) acc 100.0000 (94.3750) lr 5.0075e-04 eta 11:53:01
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4220}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-21
train_loader_x长度（batch数）: 200
单个batch样本数: 4
训练集总样本数: 200
当前使用的调度器: CosineAnnealingLR
[调度器验证] batch 20: 学习率=0.000501
epoch [22/30] batch [20/200] time 4.803 (2.523) data 4.563 (2.283) loss 0.0413 (0.2938) acc 100.0000 (93.7500) lr 5.0075e-04 eta 1:14:50
[调度器验证] batch 40: 学习率=0.002000
epoch [22/30] batch [40/200] time 9.577 (4.919) data 9.337 (4.680) loss 0.0029 (0.3072) acc 100.0000 (91.8750) lr 2.0000e-03 eta 2:24:17
[调度器验证] batch 60: 学习率=0.000501
epoch [22/30] batch [60/200] time 14.337 (7.304) data 14.102 (7.066) loss 0.2323 (0.3205) acc 100.0000 (92.0833) lr 5.0075e-04 eta 3:31:49
[调度器验证] batch 80: 学习率=0.000501
epoch [22/30] batch [80/200] time 19.132 (9.691) data 18.890 (9.452) loss 0.0022 (0.2823) acc 100.0000 (92.8125) lr 5.0075e-04 eta 4:37:48
[调度器验证] batch 100: 学习率=0.002000
epoch [22/30] batch [100/200] time 23.912 (12.081) data 23.674 (11.843) loss 0.0733 (0.2613) acc 100.0000 (93.5000) lr 2.0000e-03 eta 5:42:18
[调度器验证] batch 120: 学习率=0.000501
epoch [22/30] batch [120/200] time 28.711 (14.473) data 28.473 (14.235) loss 0.0001 (0.2661) acc 100.0000 (93.1250) lr 5.0075e-04 eta 6:45:15
[调度器验证] batch 140: 学习率=0.000501
epoch [22/30] batch [140/200] time 33.487 (16.865) data 33.249 (16.627) loss 0.0005 (0.2633) acc 100.0000 (93.3929) lr 5.0075e-04 eta 7:46:36
[调度器验证] batch 160: 学习率=0.002000
epoch [22/30] batch [160/200] time 38.317 (19.259) data 38.079 (19.020) loss 0.0565 (0.2644) acc 100.0000 (92.9688) lr 2.0000e-03 eta 8:46:25
[调度器验证] batch 180: 学习率=0.000501
epoch [22/30] batch [180/200] time 43.099 (21.656) data 42.861 (21.417) loss 0.0476 (0.2601) acc 100.0000 (93.0556) lr 5.0075e-04 eta 9:44:43
[调度器验证] batch 200: 学习率=0.000594
epoch [22/30] batch [200/200] time 47.869 (24.051) data 47.629 (23.812) loss 0.0499 (0.2523) acc 100.0000 (93.2500) lr 5.9397e-04 eta 10:41:21
保存调度器 prompt_learner 的手动状态: {'last_epoch': 4421}
Checkpoint saved to output/caltech101/CoOp_ATP/vit_b16_16shots/nctx4_cscFalse_ctpend/CTX_4_epo_30/seed1/prompt_learner/model.pth.tar-22
train_loader_x长度（batch数）: 200
